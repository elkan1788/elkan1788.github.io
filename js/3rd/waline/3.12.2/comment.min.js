const h=e=>`${e.replace(/\/?$/,"/")}api/`,g=(e,t="")=>{if(typeof e=="object"&&e.errno)throw new TypeError(`${t} failed with ${e.errno}: ${e.errmsg}`);return e},i=({serverURL:e,lang:t,paths:r,signal:o})=>fetch(`${h(e)}comment?type=count&url=${encodeURIComponent(r.join(","))}&lang=${t}`,{signal:o}).then(n=>n.json()).then(n=>g(n,"Get comment count").data),u=e=>{try{return decodeURI(e)}catch{return e}},p=(e="")=>e.replace(/\/$/u,""),m=e=>/^(https?:)?\/\//.test(e),d=e=>{const t=p(e);return m(t)?t:`https://${t}`},$=e=>{e.name!=="AbortError"&&console.error(e.message)},f=e=>{const{path:t}=e.dataset;return t!=null&&t.length?t:null},v=({serverURL:e,path:t=window.location.pathname,selector:r=".waline-comment-count",lang:o=navigator.language})=>{const n=new AbortController,a=document.querySelectorAll(r);return a.length>0&&i({serverURL:d(e),paths:Array.from(a,c=>u(f(c)??t)),lang:o,signal:n.signal}).then(c=>{a.forEach((s,l)=>{s.textContent=c[l].toString()})}).catch($),n.abort.bind(n)},w="3.12.2";export{v as commentCount,w as version};
//# sourceMappingURL=comment.js.map
