<!doctype html><html lang=zh-CN data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.139.3"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon-32x32.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple-touch-icon.png><meta itemprop=name content="Apache Nifi集群搭建及用kerberos实现用户认证"><meta itemprop=description content="再平凡的人也有属于他的梦想 ✨"><meta name=description content="再平凡的人也有属于他的梦想 ✨"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://lisenhui.cn/imgs/avatar.png"><meta itemprop=keywords content="大数据,Nifi"><meta property="og:type" content="article"><meta property="og:title" content="Apache Nifi集群搭建及用kerberos实现用户认证"><meta property="og:description" content="再平凡的人也有属于他的梦想 ✨"><meta property="og:image" content="/imgs/avatar.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://lisenhui.cn/tech/ninfi-cluster-deploy-with-kerberos.html"><meta property="og:site_name" content="热爱生活与梦想"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="凡梦星尘"><meta property="article:published_time" content="2017-10-22 11:42:29 +0000 UTC"><meta property="article:modified_time" content="2017-10-22 11:42:29 +0000 UTC"><link type=text/css rel=stylesheet href=https://s4.zstatic.net/ajax/libs/font-awesome/6.6.0/css/all.min.css><link type=text/css rel=stylesheet href=https://s4.zstatic.net/ajax/libs/animate.css/4.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://s4.zstatic.net/ajax/libs/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1733312983"><link rel=stylesheet type=text/css href="/css/custom_style.css?=1733312983"><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return void 0;const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),void 0):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"ninfi-cluster-deploy-with-kerberos.html","permalink":"https://lisenhui.cn/tech/ninfi-cluster-deploy-with-kerberos.html","title":"Apache Nifi集群搭建及用kerberos实现用户认证","waline":{"commentcnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/comment.js","name":"comment","version":"2.15.8"},"pagecnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/pageview.js","name":"pageview","version":"2.15.8"}}}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.id="LA_COLLECT",e.src="https://sdk.51.la/js-sdk-pro.min.js",e.async="true",e.onload=function(){LA.init({id:"JhW0FuUlJYQmqAJt",ck:"JhW0FuUlJYQmqAJt",autoTrack:!0})},document.head.appendChild(e)})</script><title>Apache Nifi集群搭建及用kerberos实现用户认证 - 热爱生活与梦想</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>热爱生活与梦想</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>没有伞的孩子要学会努力奔跑 ✊</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-blog"><a href=/blog/ class=hvr-icon-pulse rel=section><i class="fa fa-blog hvr-icon"></i>博客点滴</a></li><li class="menu-item menu-item-tech"><a href=/tech/ class=hvr-icon-pulse rel=section><i class="fa fa-swatchbook hvr-icon"></i>技术锦囊</a></li><li class="menu-item menu-item-life"><a href=/life/ class=hvr-icon-pulse rel=section><i class="fa fa-pizza-slice hvr-icon"></i>生活花絮</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-link hvr-icon"></i>友情链接</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>85</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class=search-result-container><div class=algolia-hits></div></div><div class=search-footer><div class=algolia-pagination></div><div class=search-meta-info><div class="search-hit-stats algolia-stats"></div><div class=search-vendor><span>Search By</span>
<a title=Algolia target=_blank href="https://www.algolia.com/?utm_source=instantsearch.js&utm_medium=website&utm_content=lisenhui.cn&utm_campaign=poweredby"><img src=/imgs/algolia-logo.svg></a></div></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-overview-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#安装kdc服务及配置>安装KDC服务及配置</a><ul><li><a href=#修改kdc默认配置>修改KDC默认配置</a></li><li><a href=#修改krb5kdc配置文件>修改KRB5KDC配置文件</a></li><li><a href=#初始化数据库>初始化数据库</a></li><li><a href=#修改数据库权限>修改数据库权限</a></li><li><a href=#启动kdc服务>启动KDC服务</a></li><li><a href=#创建数据库管理员>创建数据库管理员</a></li></ul></li><li><a href=#安装kdc-client服务>安装KDC Client服务</a><ul><li><a href=#更新配置并测试>更新配置并测试</a></li><li><a href=#拷贝keytab文件>拷贝keytab文件</a></li></ul></li></ul><ul><li><a href=#创建证书>创建证书</a></li><li><a href=#拷贝证书>拷贝证书</a></li></ul><ul><li><a href=#创建id文件>创建id文件</a></li><li><a href=#修改配置文件>修改配置文件</a></li><li><a href=#更新状态配置>更新状态配置</a></li><li><a href=#更新nifi配置>更新NIFI配置</a></li></ul><ul><li><a href=#更新nifi配置-1>更新NIFI配置</a></li><li><a href=#更新用户配置>更新用户配置</a></li><li><a href=#更新登录配置>更新登录配置</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=凡梦星尘 src=/imgs/img-lazy-loading.gif data-src=/imgs/avatar.png><p class=site-author-name itemprop=name>凡梦星尘</p><div class=site-description itemprop=description>再平凡的人也有属于他的梦想 ✨</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>85</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>28</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>128</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/elkan1788 title="Github → https://github.com/elkan1788" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=https://www.zhihu.com/people/lisenhui title="知乎 → https://www.zhihu.com/people/lisenhui" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>
知乎</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class=xyears-blog><a href=https://www.foreverblog.cn/blog/3306.html title=十年之约 target=_blank><img src=/imgs/img-lazy-loading.gif data-src=https://img.foreverblog.cn/logo_en_default.png alt=十年之约 style=height:16px>
</a><a href=https://www.foreverblog.cn/go.html title=穿梭虫洞-随机访问十年之约友链博客 target=_blank><img src=/imgs/img-lazy-loading.gif data-src=https://img.foreverblog.cn/wormhole_3.gif alt=穿梭虫洞-随机访问十年之约友链博客 style=height:24px></a></div><div class=not-by-ai><img src=/imgs/img-lazy-loading.gif data-src=/imgs/not-by-ai.png title=声明内容非AI生成 alt=声明内容非AI生成></div></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate="2010-09-05 10:11:53 +0000 UTC"></div></div><div id=la-siteinfo-widget style=display:none></div><div class=siteinfo-item><div class=item-name><i class="fa fa-user-plus"></i>今日访问：</div><div class=item-count id=today_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-user-clock"></i>昨日访问：</div><div class=item-count id=yesterday_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-arrows-down-to-people"></i>本月访问：</div><div class=item-count id=month_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-users"></i>总访问量：</div><div class=item-count id=total_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=99766></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=244></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate="2024-12-04 18:46:05 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/elkan1788 rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://lisenhui.cn/tech/ninfi-cluster-deploy-with-kerberos.html><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.png"><meta itemprop=name content="凡梦星尘"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="凡梦星尘"><meta itemprop=description content="再平凡的人也有属于他的梦想 ✨"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="Apache Nifi集群搭建及用kerberos实现用户认证"><meta itemprop=description content="最近这段时间在接触数据流式处理方面的事宜，用到了Apache NIFI现把安装配置中学习的一些经验分享下。此篇文章主要是针对集群及用户权限方面，关于

    Apache NIFI
    
    
    
的介绍就不做过多的说明，直接引用官方的首页的说明如下图所示：
"></span><header class=post-header><h1 class=post-title itemprop="name headline">Apache Nifi集群搭建及用kerberos实现用户认证
<a href=https://github.com/elkan1788/myblog-sources/tree/main/content/tech/2017/10-22-nifi-cluster-deploy-with-kerberos.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=发表于>发表于：
</span><time title="创建时间：2017年10月22日 11:42:29 CST" itemprop="dateCreated datePublished" datetime="2017-10-22 11:42:29 +0000 UTC">2017年10月22日
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分类于>分类于：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%8E%A9%E5%AE%B6/ itemprop=url rel=index><span itemprop=name>技术锦囊/大数据玩家</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字数：</span>
<span>2799</span>
</span><span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>阅读：&ap;</span>
<span>6分钟</span>
</span><span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>浏览：
</span><span id=pageview-count data-path=/tech/ninfi-cluster-deploy-with-kerberos.html><i class="fa fa-sync fa-spin"></i>
</span></span><span class=post-meta-item title><span class=post-meta-item-icon><i class="fas fa-solid fa-comments"></i>
</span><span class=post-meta-item-text title=评论>评论：
</span><span id=comments-count class=waline-comment-count data-path=/tech/ninfi-cluster-deploy-with-kerberos.html><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class=post-body itemprop=articleBody><p>最近这段时间在接触数据流式处理方面的事宜，用到了<strong>Apache NIFI</strong>现把安装配置中学习的一些经验分享下。此篇文章主要是针对集群及用户权限方面，关于
<a href=https://nifi.apache.org/ title="Apache NIFI" rel="noopener external nofollow noreferrer" target=_blank class=exturl>Apache NIFI
<i class="fa fa-external-link-alt"></i>
</a>的介绍就不做过多的说明，直接引用官方的首页的说明如下图所示：</p><p><img src=/imgs/img-lazy-loading.gif data-src=//imgs.lisenhui.cn/blog/2017/10-22-Apache-NiFi-01.png alt=NiFi-01.png></p><p><strong>Apahce NIFI</strong>的单机运行是相当的简单，易用，完全就是傻瓜式的。下载解压，进行<code>bin</code>目录执行<code>nifi.sh start</code> 打开浏览器输入<code>http://127.0.0.1:8080/nifi</code>即可看到一个简洁漂亮的WEB UI。那么接下来我们要配置的是它的集群模式，官方说明<em><strong>NIFI</strong></em>采用的是<strong>0</strong>主节点模式，集群中的每个节点在数据集上执行相同的任务，但是每个节点都在不同的数据集上运行（详细的说明请查看
<a href=https://nifi.apache.org/docs.html#clustering title=官方文档 rel="noopener external nofollow noreferrer" target=_blank class=exturl>官方文档
<i class="fa fa-external-link-alt"></i>
</a>），并且内置了<strong>Zookeeper</strong>服务，如下图所示：</p><p><img src=/imgs/img-lazy-loading.gif data-src=//imgs.lisenhui.cn/blog/2017/10-22-zero-master-cluster-http-access.png alt=zero-master-cluster-http-access.png></p><h1 id=系统环境及软件版本>系统环境及软件版本
<a class=header-anchor href=#%e7%b3%bb%e7%bb%9f%e7%8e%af%e5%a2%83%e5%8f%8a%e8%bd%af%e4%bb%b6%e7%89%88%e6%9c%ac></a></h1><ul><li><p>CentOS7</p></li><li><p>JDK1.8.0_91</p></li><li><p>Nifi-1.4.0</p></li><li><p>Kerberos5</p></li></ul><blockquote><p>(其它版本可参考此篇文章)</p></blockquote><table><thead><tr><th style=text-align:center>HostName</th><th style=text-align:center>IP</th><th style=text-align:center>Services</th></tr></thead><tbody><tr><td style=text-align:center>centos7-master</td><td style=text-align:center>192.168.56.100</td><td style=text-align:center>Kerberos5 Server, Nifi Cluster Manager</td></tr><tr><td style=text-align:center>centos7-cluster01</td><td style=text-align:center>192.168.56.101</td><td style=text-align:center>Kerberos5 Client, Nifi Cluster</td></tr></tbody></table><h1 id=搭建kerberos5服务>搭建Kerberos5服务
<a class=header-anchor href=#%e6%90%ad%e5%bb%bakerberos5%e6%9c%8d%e5%8a%a1></a></h1><h2 id=安装kdc服务及配置>安装KDC服务及配置
<a class=header-anchor href=#%e5%ae%89%e8%a3%85kdc%e6%9c%8d%e5%8a%a1%e5%8f%8a%e9%85%8d%e7%bd%ae></a></h2><p>进入到Master机器，执行以下命令安装<strong>KDC</strong>服务：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>yum -y install krb5-server krb5-libs krb5-workstation
</span></span></code></pre></td></tr></table></div></div><blockquote><p>注：测试中发现<code>krb5-auth-dialo</code>组件是不可用的，也无需安装</p></blockquote><h3 id=修改kdc默认配置>修改KDC默认配置
<a class=header-anchor href=#%e4%bf%ae%e6%94%b9kdc%e9%bb%98%e8%ae%a4%e9%85%8d%e7%bd%ae></a></h3><p>进入<code>/etc</code>目录找到<code>/etc/krb5.conf</code>文件打开并修改，参考如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#75715e># Configuration snippets may be placed in this directory as well</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>includedir</span> <span style=color:#e6db74>/etc/krb5.conf.d/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>[logging]</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>default</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>FILE:/var/log/krb5libs.log</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>kdc</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>FILE:/var/log/krb5kdc.log</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>admin_server</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>FILE:/var/log/kadmind.log</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>[libdefaults]</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>dns_lookup_realm</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>false</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>ticket_lifetime</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>24h</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>renew_lifetime</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>7d</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>forwardable</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>true</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>rdns</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>false</span>
</span></span><span style=display:flex><span> <span style=color:#75715e># 这个注释需要开启，并填写默认的域</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>default_realm</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>CENTOS7-MASTER.COM</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>default_ccache_name</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>KEYRING:persistent:%{uid}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>[realms]</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># 把此处的EXAMPLE.COM修改成自己的域</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>CENTOS7-MASTER.COM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>{</span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>kdc</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>centos7-master</span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>admin_server</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>centos7-master</span>
</span></span><span style=display:flex><span>   <span style=color:#75715e># 添加默认的域</span>
</span></span><span style=display:flex><span>   <span style=color:#a6e22e>default_domain</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>CENTOS7-MASTER.COM</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>  }</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>[domain_realm]</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># 把此处的EXAMPLE.COM修改成自己的域名</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>.centos7-master.com</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>CENTOS7-MASTER.COM</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>centos7-master.com</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>CENTOS7-MASTER.COM</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=修改krb5kdc配置文件>修改KRB5KDC配置文件
<a class=header-anchor href=#%e4%bf%ae%e6%94%b9krb5kdc%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6></a></h3><p>进入<code>/etc</code>目录找到<code>/var/kerberos/krb5kdc/kdc.conf</code>文件打开，参考如下修改：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>[kdcdefaults]</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>kdc_ports</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>88</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>kdc_tcp_ports</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>88</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>[realms]</span>
</span></span><span style=display:flex><span> <span style=color:#75715e># 修改此处的EXAMPLE.COM域名</span>
</span></span><span style=display:flex><span> <span style=color:#a6e22e>CENTOS7-MASTER.COM</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>{</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#master_key_type = aes256-cts</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>acl_file</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/var/kerberos/krb5kdc/kadm5.acl</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>dict_file</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/usr/share/dict/words</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>admin_keytab</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/var/kerberos/krb5kdc/kadm5.keytab</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>supported_enctypes</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>aes256-cts:normal aes128-cts:normal des3-hmac-sha1:normal arcfour-hmac:normal camellia256-cts:normal camellia128-cts:normal des-hmac-sha1:normal des-cbc-md5:normal des-cbc-crc:normal</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>kdc_ports</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>88</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>kadmind_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>749</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010> }</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=初始化数据库>初始化数据库
<a class=header-anchor href=#%e5%88%9d%e5%a7%8b%e5%8c%96%e6%95%b0%e6%8d%ae%e5%ba%93></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kdb5_util create -s</span>
</span></span><span style=display:flex><span>Loading random data
</span></span><span style=display:flex><span>Initializing database <span style=color:#e6db74>&#39;/var/kerberos/principal&#39;</span> <span style=color:#66d9ef>for</span> realm <span style=color:#e6db74>&#39;CENTOS7-MASTER.COM&#39;</span>,
</span></span><span style=display:flex><span>master key name <span style=color:#e6db74>&#39;K/M@CENTOS7-MASTER.COM&#39;</span>
</span></span><span style=display:flex><span>You will be prompted <span style=color:#66d9ef>for</span> the database Master Password.
</span></span><span style=display:flex><span>It is important that you NOT FORGET this password.
</span></span><span style=display:flex><span>Enter KDC database master key:
</span></span><span style=display:flex><span>Re-enter KDC database master key to verify:
</span></span></code></pre></td></tr></table></div></div><h3 id=修改数据库权限>修改数据库权限
<a class=header-anchor href=#%e4%bf%ae%e6%94%b9%e6%95%b0%e6%8d%ae%e5%ba%93%e6%9d%83%e9%99%90></a></h3><p>找到<code>/var/kerberos/krb5kdc/kadm5.acl</code>配置文件，给数据库管理员添加ACL权限，*代表全部权限，操作如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master ~<span style=color:#f92672>]</span><span style=color:#75715e># vi /var/kerberos/krb5kdc/kadm5.acl</span>
</span></span><span style=display:flex><span>*/admin@CENTOS7-MASTER.COM   *
</span></span></code></pre></td></tr></table></div></div><h3 id=启动kdc服务>启动KDC服务
<a class=header-anchor href=#%e5%90%af%e5%8a%a8kdc%e6%9c%8d%e5%8a%a1></a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Shell data-lang=Shell><span style=display:flex><span>service krb5kdc start
</span></span><span style=display:flex><span>service kadmin start
</span></span></code></pre></td></tr></table></div></div><h3 id=创建数据库管理员>创建数据库管理员
<a class=header-anchor href=#%e5%88%9b%e5%bb%ba%e6%95%b0%e6%8d%ae%e5%ba%93%e7%ae%a1%e7%90%86%e5%91%98></a></h3><p>参考如下命令创建管理员用户，保存好创建时设置的密码(如果忘记后期可以使用<code>cpw</code>命令更新)，并导出<strong>keytab</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kadmin.local -q &#34;addprinc root/admin&#34;</span>
</span></span><span style=display:flex><span>Authenticating as principal root/admin@CENTOS7-MASTER.COM with password.
</span></span><span style=display:flex><span>WARNING: no policy specified <span style=color:#66d9ef>for</span> root/admin@CENTOS7-MASTER.COM; defaulting to no policy
</span></span><span style=display:flex><span>Enter password <span style=color:#66d9ef>for</span> principal <span style=color:#e6db74>&#34;root/admin@CENTOS7-MASTER.COM&#34;</span>:
</span></span><span style=display:flex><span>Re-enter password <span style=color:#66d9ef>for</span> principal <span style=color:#e6db74>&#34;root/admin@CENTOS7-MASTER.COM&#34;</span>:
</span></span><span style=display:flex><span>Principal <span style=color:#e6db74>&#34;root/admin@CENTOS7-MASTER.COM&#34;</span> created.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kadmin.local</span>
</span></span><span style=display:flex><span>kadmin: ktadd -k /data/root.keytab root/admin
</span></span><span style=display:flex><span>kadmin: q
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master ~<span style=color:#f92672>]</span><span style=color:#75715e># kinit root/admin</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=安装kdc-client服务>安装KDC Client服务
<a class=header-anchor href=#%e5%ae%89%e8%a3%85kdc-client%e6%9c%8d%e5%8a%a1></a></h2><p>进入从Cluster机器，执行如下命令安装<strong>KDC Cliente</strong>服务：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Shell data-lang=Shell><span style=display:flex><span>yum -y install krb5-libs krb5-workstation
</span></span></code></pre></td></tr></table></div></div><h3 id=更新配置并测试>更新配置并测试
<a class=header-anchor href=#%e6%9b%b4%e6%96%b0%e9%85%8d%e7%bd%ae%e5%b9%b6%e6%b5%8b%e8%af%95></a></h3><p>拷贝主节点的<code>krb5.conf</code>和<code>root.keytab</code>到从节点服务，参考如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-cluster01 ~<span style=color:#f92672>]</span><span style=color:#75715e># scp root@centos7-master:/etc/krb5.conf /etc/krb5.conf</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-cluster01 ~<span style=color:#f92672>]</span><span style=color:#75715e># scp root@centos7-master:/data/root.keytab /data/root.keytab</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-cluster01 ~<span style=color:#f92672>]</span><span style=color:#75715e># kadmin -p root/admin</span>
</span></span><span style=display:flex><span>Authenticating as principal root/admin with password.
</span></span><span style=display:flex><span>Password <span style=color:#66d9ef>for</span> root/admin@CENTOS7-MASTER.COM:
</span></span><span style=display:flex><span>kadmin:
</span></span></code></pre></td></tr></table></div></div><h3 id=拷贝keytab文件>拷贝keytab文件
<a class=header-anchor href=#%e6%8b%b7%e8%b4%9dkeytab%e6%96%87%e4%bb%b6></a></h3><p>拷贝<strong>root.keytab</strong>到<code>/data/root.keytab</code>目录，注意此处指的是所有机器</p><h1 id=创建nifi服务证书>创建Nifi服务证书
<a class=header-anchor href=#%e5%88%9b%e5%bb%banifi%e6%9c%8d%e5%8a%a1%e8%af%81%e4%b9%a6></a></h1><h2 id=创建证书>创建证书
<a class=header-anchor href=#%e5%88%9b%e5%bb%ba%e8%af%81%e4%b9%a6></a></h2><p>解压<code>nifi-toolkit-1.4.0-bin.tar.gz</code>文件后进入<code>bin</code>目录，执行以下的命令：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Shell data-lang=Shell><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master ~<span style=color:#f92672>]</span><span style=color:#75715e># ./tls-toolkit.sh standalone -n &#39;centos7-master, centos7-cluster01&#39; -C &#39;CN=admin, OU=ApacheNIFI&#39; -o &#39;./target&#39; -f &#39;/usr/local/bin/nifi-ncm/conf/nifi.properties&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master target<span style=color:#f92672>]</span><span style=color:#75715e># tree</span>
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>├── centos7-cluster01
</span></span><span style=display:flex><span>│   ├── keystore.jks
</span></span><span style=display:flex><span>│   ├── nifi.properties
</span></span><span style=display:flex><span>│   └── truststore.jks
</span></span><span style=display:flex><span>├── centos7-master
</span></span><span style=display:flex><span>│   ├── keystore.jks
</span></span><span style=display:flex><span>│   ├── nifi.properties
</span></span><span style=display:flex><span>│   └── truststore.jks
</span></span><span style=display:flex><span>├── CN<span style=color:#f92672>=</span>admin_OU<span style=color:#f92672>=</span>ApacheNIFI.p12
</span></span><span style=display:flex><span>├── CN<span style=color:#f92672>=</span>admin_OU<span style=color:#f92672>=</span>ApacheNIFI.password
</span></span><span style=display:flex><span>├── nifi-cert.pem
</span></span><span style=display:flex><span>└── nifi-key.key
</span></span></code></pre></td></tr></table></div></div><blockquote><ul><li>-n 表示机器的hostname</li><li>-C 生成浏览器证书（<strong>注意：</strong> CN=admin, 后面的<strong>空格</strong>一定要保留）</li><li>-o 输出的目录</li><li>-f Nifi的配置文件位置</li></ul></blockquote><h2 id=拷贝证书>拷贝证书
<a class=header-anchor href=#%e6%8b%b7%e8%b4%9d%e8%af%81%e4%b9%a6></a></h2><p>拷贝生成好证书到主从节点服务器下<code>NIFI</code>安装目录中的<strong>conf</strong>文件夹，如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master target<span style=color:#f92672>]</span><span style=color:#75715e># scp centos7-cluster01/* centos7-cluster01:/usr/local/bin/nifi-cluster01/conf</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master target<span style=color:#f92672>]</span><span style=color:#75715e># cp target/centos7-master/* /usr/local/bin/nifi-ncm/conf/</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=配置zookeeper服务>配置Zookeeper服务
<a class=header-anchor href=#%e9%85%8d%e7%bd%aezookeeper%e6%9c%8d%e5%8a%a1></a></h1><blockquote><p><strong>注意</strong>：所有的主从节点都需要操作</p></blockquote><h2 id=创建id文件>创建id文件
<a class=header-anchor href=#%e5%88%9b%e5%bb%baid%e6%96%87%e4%bb%b6></a></h2><p>进入到NIFI安装目录下，并创建<code>state/zookeeper</code>目录和<code>myid</code>文件，然后把对应的ID写入到文件中，操作如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master nifi-ncm<span style=color:#f92672>]</span><span style=color:#75715e># mkdir -p state/zookeeper</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@centos7-master nifi-ncm<span style=color:#f92672>]</span><span style=color:#75715e># echo -n &#39;1&#39; &gt; state/zookeeper/myid</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p><strong>注意：</strong> 从节点上创建的myid为2，如：<code>echo -n '2' > state/zookeeper/myid</code></p></blockquote><h2 id=修改配置文件>修改配置文件
<a class=header-anchor href=#%e4%bf%ae%e6%94%b9%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6></a></h2><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>clientPort<span style=color:#f92672>=</span><span style=color:#ae81ff>2181</span>
</span></span><span style=display:flex><span>initLimit<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>autopurge.purgeInterval<span style=color:#f92672>=</span><span style=color:#ae81ff>24</span>
</span></span><span style=display:flex><span>syncLimit<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>tickTime<span style=color:#f92672>=</span><span style=color:#ae81ff>2000</span>
</span></span><span style=display:flex><span>dataDir<span style=color:#f92672>=</span>./state/zookeeper
</span></span><span style=display:flex><span>autopurge.snapRetainCount<span style=color:#f92672>=</span><span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Specifies the servers that are part of this zookeeper ensemble. For</span>
</span></span><span style=display:flex><span><span style=color:#75715e># every NiFi instance running an embedded zookeeper, there needs to be</span>
</span></span><span style=display:flex><span><span style=color:#75715e># a server entry below. For instance:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># server.1=nifi-node1-hostname:2888:3888</span>
</span></span><span style=display:flex><span><span style=color:#75715e># server.2=nifi-node2-hostname:2888:3888</span>
</span></span><span style=display:flex><span><span style=color:#75715e># server.3=nifi-node3-hostname:2888:3888</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># The index of the server corresponds to the myid file that gets created</span>
</span></span><span style=display:flex><span><span style=color:#75715e># in the dataDir of each node running an embedded zookeeper. See the</span>
</span></span><span style=display:flex><span><span style=color:#75715e># administration guide for more details.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 注意修改成你对应的服务器地址</span>
</span></span><span style=display:flex><span>server.1<span style=color:#f92672>=</span>centos7-master:2888:3888
</span></span><span style=display:flex><span>server.2<span style=color:#f92672>=</span>centos7-cluster01:2888:3888
</span></span></code></pre></td></tr></table></div></div><h2 id=更新状态配置>更新状态配置
<a class=header-anchor href=#%e6%9b%b4%e6%96%b0%e7%8a%b6%e6%80%81%e9%85%8d%e7%bd%ae></a></h2><p>进入到Nifif安装目录下修改<code>conf/state-management.xml</code>配置，在<strong>zk-provider</strong>节点下添加连接字符串</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;cluster-provider&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;id&gt;</span>zk-provider<span style=color:#f92672>&lt;/id&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;class&gt;</span>org.apache.nifi.controller.state.providers.zookeeper.ZooKeeperStateProvider<span style=color:#f92672>&lt;/class&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Connect String&#34;</span><span style=color:#f92672>&gt;</span>centos7-master:2181,centos7-cluster01:2181<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Root Node&#34;</span><span style=color:#f92672>&gt;</span>/nifi<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Session Timeout&#34;</span><span style=color:#f92672>&gt;</span>10 seconds<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Access Control&#34;</span><span style=color:#f92672>&gt;</span>Open<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/cluster-provider&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=更新nifi配置>更新NIFI配置
<a class=header-anchor href=#%e6%9b%b4%e6%96%b0nifi%e9%85%8d%e7%bd%ae></a></h2><p>进入到Nifif安装目录下修改<code>conf/nifi.properties</code>文件，把内置的<code>zookeeper</code>启动和<code>cluster</code>设置成<code>true</code>，如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#a6e22e>nifi.state.management.embedded.zookeeper.start</span><span style=color:#f92672>=</span><span style=color:#e6db74>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>nifi.cluster.is.node</span><span style=color:#f92672>=</span><span style=color:#e6db74>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># zookeeper properties, used for cluster management #</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>nifi.zookeeper.connect.string</span><span style=color:#f92672>=</span><span style=color:#e6db74>centos7-master:2181,centos7-cluster01:2181</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>nifi.zookeeper.connect.timeout</span><span style=color:#f92672>=</span><span style=color:#e6db74>3 secs</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>nifi.zookeeper.session.timeout</span><span style=color:#f92672>=</span><span style=color:#e6db74>3 secs</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>nifi.zookeeper.root.node</span><span style=color:#f92672>=</span><span style=color:#e6db74>/nifi</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=配置nifi-admin初始化>配置Nifi Admin初始化
<a class=header-anchor href=#%e9%85%8d%e7%bd%aenifi-admin%e5%88%9d%e5%a7%8b%e5%8c%96></a></h1><h2 id=更新nifi配置-1>更新NIFI配置
<a class=header-anchor href=#%e6%9b%b4%e6%96%b0nifi%e9%85%8d%e7%bd%ae-1></a></h2><p>进入到Nifif安装目录修改<code>conf/nifi.properties</code>文件，把<code>kerberos5</code>的登录适配加上，如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#a6e22e>nifi.kerberos.krb5.file</span><span style=color:#f92672>=</span><span style=color:#e6db74>/etc/krb5.conf</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># kerberos service principal #</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>nifi.kerberos.service.principal</span><span style=color:#f92672>=</span><span style=color:#e6db74>root/admin@CENTOS7-MASTER.COM</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>nifi.kerberos.service.keytab.location</span><span style=color:#f92672>=</span><span style=color:#e6db74>/data/root.keytab</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=更新用户配置>更新用户配置
<a class=header-anchor href=#%e6%9b%b4%e6%96%b0%e7%94%a8%e6%88%b7%e9%85%8d%e7%bd%ae></a></h2><p>进入到Nifif安装目录中的conf目录，添加<code>authorizer</code>到<code>authorizers.xml</code>，打开<code>file-provider</code>节点注释并添加如下内容：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;authorizer&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;identifier&gt;</span>file-provider<span style=color:#f92672>&lt;/identifier&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;class&gt;</span>org.apache.nifi.authorization.FileAuthorizer<span style=color:#f92672>&lt;/class&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Authorizations File&#34;</span><span style=color:#f92672>&gt;</span>./conf/authorizations.xml<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Users File&#34;</span><span style=color:#f92672>&gt;</span>./conf/users.xml<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Initial Admin Identity&#34;</span><span style=color:#f92672>&gt;</span>root/admin@CENTOS7-MASTER.COM<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Legacy Authorized Users File&#34;</span><span style=color:#f92672>&gt;&lt;/property&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Node Identity 1&#34;</span><span style=color:#f92672>&gt;</span>CN=centos7-master, OU=NIFI<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Node Identity 2&#34;</span><span style=color:#f92672>&gt;</span>CN=centos7-cluster01, OU=NIFI<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/authorizer&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=更新登录配置>更新登录配置
<a class=header-anchor href=#%e6%9b%b4%e6%96%b0%e7%99%bb%e5%bd%95%e9%85%8d%e7%bd%ae></a></h2><p>进入到Nifif安装目录中的conf目录，修改<code>login-identity-providers.xml </code>文件，打开<code>kerberos-provider</code>节点注释：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;provider&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;identifier&gt;</span>kerberos-provider<span style=color:#f92672>&lt;/identifier&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;class&gt;</span>org.apache.nifi.kerberos.KerberosProvider<span style=color:#f92672>&lt;/class&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Default Realm&#34;</span><span style=color:#f92672>&gt;</span>CENTOS7-MASTER.COM<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Kerberos Config File&#34;</span><span style=color:#f92672>&gt;</span>/etc/krb5.conf<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;property</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Authentication Expiration&#34;</span><span style=color:#f92672>&gt;</span>12 hours<span style=color:#f92672>&lt;/property&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/provider&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=启动nifi服务>启动NIFI服务
<a class=header-anchor href=#%e5%90%af%e5%8a%a8nifi%e6%9c%8d%e5%8a%a1></a></h1><p>先启动主节点的NIFI，而后启动从节点的NIFI，执行命令<code>./bin/nifi.sh start</code>， 然后打开浏览器输入<code>https://centos7-master:9443/nifi/</code>便会跳转到登录页面，输入在第1步骤创建的用户与密码，即可登录成功。界面显示如下：</p><p><img src=/imgs/img-lazy-loading.gif data-src=//imgs.lisenhui.cn/blog/2017/10-22-Apache-NiFi-02.png alt="Apache NiFi02"></p><p><img src=/imgs/img-lazy-loading.gif data-src=//imgs.lisenhui.cn/blog/2017/10-22-Apache-NiFi-03.png alt="Apache NiFi03"></p><p>如上面两图显示，在界面的左上角可以清楚的看到当前节点数为2，用户为**<code>root/admin@CENTOS7-MASTER.COM</code>**，其中<code>centos7-master</code>是协调器，<code>centos7-cluster01</code>是主要节点，主菜单中也增加有了<code>Cluster</code>，<code>User</code>和<code>Policies</code>选项。</p><p>至此<code>Apache NIFI</code>的集群服务与用户认证便完成好啦，后面便可开展下一步的工作。</p><blockquote><p><em>遇到的坑：</em></p><ul><li>首次登录时提示用户名或密码无效，可通过kadmin更新用户的密码</li><li>登录成功后提示用户没有对应的策略，重启NIFI服务即可</li></ul></blockquote><p>引用参考</p><ul><li><a href=https://community.hortonworks.com/articles/34147/nifi-security-user-authentication-with-kerberos.html title=nifi-security-user-authentication-with-kerberos.html rel="noopener external nofollow noreferrer" target=_blank class=exturl>nifi-security-user-authentication-with-kerberos.html
<i class="fa fa-external-link-alt"></i></a></li><li><a href="http://blog.csdn.net/sinat_34233802/article/details/68942176?locationNum=1&amp;fps=1" title=Nifi-搭建 rel="noopener external nofollow noreferrer" target=_blank class=exturl>Nifi-搭建
<i class="fa fa-external-link-alt"></i></a></li><li><a href=http://blog.csdn.net/wulantian/article/details/42418231 title=kerberos认证原理&mdash;讲的非常细致，易懂 rel="noopener external nofollow noreferrer" target=_blank class=exturl>kerberos认证原理&mdash;讲的非常细致，易懂
<i class="fa fa-external-link-alt"></i></a></li><li><a href=http://blog.csdn.net/post_yuan/article/details/54406148 title="Kerberos 基本安装与配置" rel="noopener external nofollow noreferrer" target=_blank class=exturl>Kerberos 基本安装与配置
<i class="fa fa-external-link-alt"></i></a></li></ul><p><strong>收到的赏金</strong>
<em>感谢各位的慷慨解囊!</em></p><table><thead><tr><th style=text-align:center>序号</th><th style=text-align:center>昵称</th><th style=text-align:center>来源</th><th style=text-align:center>金额(元)</th><th style=text-align:center>留言</th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center>林俗人</td><td style=text-align:center>微信</td><td style=text-align:center>2</td><td style=text-align:center>感谢博主，感谢分享!</td></tr></tbody></table></div><footer class=post-footer><div class=post-tags><a href=/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/>大数据
</a><a href=/tags/nifi/>Nifi</a></div><div class=post-share-tools><div class=post-share-loading><i class="fa-solid fa-ellipsis fa-spin"></i></div><div class=sharethis-inline-share-buttons></div></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>
赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/ali-pay.png alt="凡梦星尘 - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/img-lazy-loading.gif data-src=/imgs/wechat-pay.png alt="凡梦星尘 - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right alt=共享知识><ul><li class=post-copyright-title><strong>文章标题：</strong>
Apache Nifi集群搭建及用kerberos实现用户认证</li><li class=post-copyright-author><strong>本文作者： </strong>凡梦星尘</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://lisenhui.cn/tech/ninfi-cluster-deploy-with-kerberos.html title="Apache Nifi集群搭建及用kerberos实现用户认证">https://lisenhui.cn/tech/ninfi-cluster-deploy-with-kerberos.html</a></li><li class=post-copyright-license><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/imgs/qq-channel.jpg><span class=icon><i class="fab fa-qq"></i>
</span><span class=label>QQ</span></a></div><div class=social-item><a target=_blank class=social-link href=/rss.xml><span class=icon><i class="fa fa-rss"></i>
</span><span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/tech/nifi-windows-local-cluster.html rel=next title="Apache Nifi在Windows环境下搭建伪群集及证书登录"><i class="fa fa-chevron-left"></i> Apache Nifi在Windows环境下搭建伪群集及证书登录</a></div><div class="post-nav-prev post-nav-item"><a href=/tech/ambari-monitor-status-issues.html rel=prev title=关于Ambari中服务运行正常UI却显示服务停止的问题>关于Ambari中服务运行正常UI却显示服务停止的问题
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div><div class=comment-switch><span class=first-comment>Waline</span>
<span class=switch-btn></span>
<span class=second-comment>Giscus</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2024
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>凡梦星尘</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.139.3 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.7.0 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备18047355号-1</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://vercel.com title=Vercel><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/vercel.svg alt=Vercel>
</a><a target=_blank href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral" title=又拍云><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/upyun.png alt=又拍云>
</a><a target=_blank href=https://github.com title=Github><img src=/imgs/img-lazy-loading.gif data-src=/imgs/vendors/github.svg alt=Github>
</a><a target=_blank href=https://www.leancloud.cn title=LeanCloud><img src=/imgs/img-lazy-loading.gif data-src=https://www.leancloud.cn/favicon.png alt=LeanCloud>
</a><a target=_blank href=https://www.zstatic.net title=zstatic><img src=/imgs/img-lazy-loading.gif data-src=https://www.zstatic.net/logo.png alt=zstatic>
</a><span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=https://s4.zstatic.net/ajax/libs/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://s4.zstatic.net/ajax/libs/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"algolia":{"cfg":{"apikey":"639c3c5992507251ead7be2153913cd0","appid":"NC5VDOMBRG","enable":true,"hits":{"perpage":10},"indexname":"site_indexes","limit":1e3},"instantjs":{"file":"dist/instantsearch.production.min.js","name":"instantsearch.js","version":"4.73.2"},"js":{"file":"dist/algoliasearch-lite.umd.js","name":"algoliasearch","version":"4.24.0"}},"bookmark":{"color":"#1b1b1b","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Comments","categoryid":"DIC_kwDOE8dfY84CQqz_","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"elkan1788/elkan1788.github.io","repoid":"MDEwOlJlcG9zaXRvcnkzMzE4MzMxODc=","theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://lisenhui.cn/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"找到 ${hits} 个搜索结果","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lawidget":{"id":"JhW0FuUlJYQmqAJt","js":"https://v6-widget.51.la/v6/laId/quote.js?theme=0\u0026col=true\u0026f=12\u0026display=0,0,0,1,0,1,1,1"},"lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"rotateInUpRight"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"waline"}},"root":"/","scheme":"Gemini","share":{"enable":true,"sharethis":{"id":"66aeda3e566923001d52f16c","js":"https://platform-api.sharethis.com/js/sharethis.js#property=id\u0026product=inline-share-buttons\u0026source=platform"}},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"zstatic","router":{"home":"https://www.zstatic.net","logo":"https://www.zstatic.net/logo.png","name":"zstatic","type":"modern","url":"https://s4.zstatic.net/ajax/libs"}},"version":"4.7.0","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o \n\n可用快捷键选取表情符号：😀😄😁🥳👻👽👀🚄\n(Window系统：Win+.，Mac系统：Control+Command+Space)","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":"https://waline.lisenhui.cn/","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"2.15.8"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"2.15.8"}}}</script><script type=text/javascript src="/js/main.min.js?=1733312984" defer></script></body></html>