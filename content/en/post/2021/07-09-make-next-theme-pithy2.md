---
title: Make Hugo NexT theme pithy 2
url: "2021/07/09/make-next-theme-pithy2.html"
date: "2021-07-09T17:53:06+08:00"
draft: false
tags:
  - NexT
  - 博客
  - Hugo
categories:
  - 博客
toc: true
---

## 1. Background
The `NexT` theme has been optimized and shared in GitHub repository since last time [__hugo-theme-next__]（ https://github.com/elkan1788/hugo-theme-next ）After, it has also been used and email feedback by many `NexT` theme lovers. So I decided to take some effort to maintain it, so I rejoined some of my previous ideas into the theme of `NexT`, and updated the functions of some plug-ins at the same time.
The version code released after this optimization is `3.X', because the overall structure and previous changes are relatively large (mainly reflected in the configuration). Therefore, the relevant introduction of the theme and other information are also rewritten. At present, it is applying to be added to the official theme list ([click preview]( https://deploy-preview-73--hugothemes.netlify.app/themes/hugo-theme-next/)), welcome your use and feedback.

<!--more-->

## 2. Switching between Chinese and English
Maybe you think this function is a little weak, because the traffic of personal blog is not very large. However, small traffic does not mean no traffic, so we can still add a Chinese English switching function to help us promote our blog space. Moreover, the development of 'Hugo' engine in multilingualism is also relatively simple, but now it is in manual mode, which means you are publishing two articles. The effect reference after adding Chinese and English switching function is as follows: (i.e. adding switching entry in the upper left corner)

![Translate Function](//imgs.lisenhui.cn/blog/2021/07-09-hugo-next-translate-func.png)

> Later, consider whether it is possible to introduce automatic translation mode to load, which can reduce the time spent writing articles.

## 3.Reconfiguration configuration
Combined with the above Chinese English bilingual switching function, the configuration content management of the theme will become more chaotic. I don't like to write too many configuration parameters in a file. This idea coincides with the design of the `Hugo` engine. It naturally supports the independent configuration of different parameters according to the classified management mode.

![Setting Files](//imgs.lisenhui.cn/blog/2021/07-09-hugo-next-setting-files.png)

At the same time, the configuration of each service component used in this topic is also classified, which makes the display clearer and convenient for subsequent parameter adjustment and optimization.

![Setting Parameters](//imgs.lisenhui.cn/blog/2021/07-09-hugo-next-setting-paras.png)

## 4. Addthis share plug-in
The 'BShare' plug-in originally used in the theme, but it was suddenly found that it could not be referenced normally one day. It's really a sigh that after Baidu sharing plug-ins, another domestic sharing plug-ins came to an end. So later, I found a popular plug-in 'addthis' abroad. After some research, it was finally successfully integrated to replace the original' bShare 'plug-in.

Enabling in the topic is also relatively simple, which is divided into the following two steps:
- Register an account on the official website of 'addthis' ([click Register]( https://www.addthis.com/register)), and then get the personal ID number, like this: `ra-6049e46e9ee54287`;
- Find the share configuration item in the configuration file and set two parameters: 'enable = true' and 'addthisid = "your addthispubid";

The effects achieved are as follows:

![Add this Share](//imgs.lisenhui.cn/blog/2021/07-09-hugo-next-addthis-share.png)

## 5.Local search optimization
The index file generated by local search is overwritten to ` robots.txt `, but in the case of bilingual Chinese and English, it can not support two different Chinese and English indexes, so the original index generation method needs to be modified. This is another time to feel the power of the `Hugo` engine. It can fully support custom output files, which only needs the following lines of configuration:

```tmol
[outputFormats]
  [outputFormats.SearchIndex]
    mediaType = "application/xml"
    baseName = "searchindex"
    isPlainText = true
    notAlternative = true

[outputs]
  home = ["HTML", "RSS", "SearchIndex"]
```

## 6.Support mathematical formula
Some netizens reported that this topic could not support the rendering of mathematical formulas. Later, after analysis, it was found that the `mathjax` file was removed in the previous optimization file reference. So this function is repaired again. When using it, you only need to add `Math: true` configuration to the page parameters of the article. The effect is as follows:

![Math Function](//imgs.lisenhui.cn/blog/2021/07-09-hugo-next-math-func.png)

## 7.Waline review
The original theme used a comment plug-in of `Valine`, but the security of this non commented plug-in is also a "bloody" Discussion on the Internet, but we won't participate in too much discussion. In this context, someone derived the `Waline` plug-in to solve the security risks through the deployment of the server. I still prefer its comment management function (which can effectively shield this malicious irrigation), so I launched another research, successfully deployed my own comment background service on `vercel`, and also upgraded and referenced this comment plug-in function in the blog.
The deployment of this comment plug-in still needs some "cost" relatively, but the official documents are very perfect and the community answers are very active. You can use it safely and quickly. Specific reference: [guide](https://waline.js.org/guide/get-started.html#vercel-%E9%83%A8%E7%BD%B2-%E6%9C%8D%E5%8A%A1%E7%AB%AF)

Then find the `comment` configuration item in the configuration parameters, fill in the following information, and you can see the comment box on the blog page.

```toml
[Comment]
  Enable = true
  Module = "Waline"
  WalineSerURL = "Your WalineSerURL"
```

## 8.Gitee drawing bed
More or less, pictures are used in blogging. With the passage of years, the benefits of "picking wool" no longer exist. There have been different service providers in the middle. Now you'd better give up and upload all the pictures to the warehouse. Considering that most of the visiting users are in China, the pages service of `gitee` is used as the drawing bed.

>Fortunately, when I first wrote a blog, the classification management of pictures was relatively clear, and it was not too painful to change the picture bed. It was just a key to change an access domain name. On the necessity of architecture design!!!

## 9.Other optimization
The rest is about the display style and the adaptation between different devices. Although it seems very simple, but really cut in and found that debugging is really painful. During the repair process, we also specially went to the `Next` theme of the `Hexo` engine version to "cheat", and added some effect animation on the display of mobile devices to enhance the operation experience.

## 10.summary
I prefer the simplicity and freshness of `NexT`. These transformation and optimization work is to make the theme more perfect and easy to use. I will not change the original design intention of the `NexT` theme. I hope the `NexT` theme can continue to shine and heat under the 'Hugo' engine.
In the follow-up, the user manual and other issues of the theme will be gradually optimized. More netizens who love `NexT` are also welcome to participate in the joint construction and look forward to it.

![my-hugo-blog](https://imgs.lisenhui.cn/blog/my-hugo-blog.png)