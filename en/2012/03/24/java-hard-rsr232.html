<!doctype html><html lang=en dir=content/en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=content-security-policy content="upgrade-insecure-requests"><title>Java program and RSR232 serial communication skills - Loving life and dreams.</title><meta name=keywords content="Blog | Software | Architecture | Java | Kylin"><meta name=author content="Elkan.Li"><meta property="og:title" content="Java program and RSR232 serial communication skills"><meta property="og:site_name" content="Loving life and dreams."><meta property="og:image" content="/img/author.jpg"><meta name=title content="Java program and RSR232 serial communication skills - Loving life and dreams."><meta name=description content="Blog | Software | Architecture | Java | Kylin"><link rel="shortcut icon" href=/img/favicon.ico><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=apple-touch-icon-precomposed href=/img/apple-touch-icon.png><link href=//cdn.bootcdn.net/ajax/libs/font-awesome/4.6.2/css/font-awesome.min.css rel=stylesheet type=text/css><link href=//cdn.bootcdn.net/ajax/libs/imageviewer/0.1.0/viewer.min.css rel=stylesheet><link href=/css/main.css rel=stylesheet type=text/css><link href=/css/syntax.css rel=stylesheet type=text/css><script type=text/javascript>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?9b021cbfb58b35e79012f9690de1c6ab";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-61491374-4"></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-61491374-4 ');</script></head><body itemscope itemtype=http://schema.org/WebPage lang=zh-hans><div class="container one-collumn sidebar-position-left page-home"><div class=headband></div><header id=header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-meta><div class=multi-lang-switch><i class="fa fa-fw fa-language" style=margin-right:5px></i><a class=lang-link id=zh-cn href=https://lisenhui.cn/2012/03/24/java-hard-rsr232.html>中文</a>
<span class=lang-line>/</span>
<a class=lang-link id=en href=#>English</a></div><div class=custom-logo-site-title><a href=/en/ class=brand rel=start><span class=logo-line-before><i></i></span><span class=site-title>Loving life and dreams.</span>
<span class=logo-line-after><i></i></span></a></div><p class=site-subtitle>Don't stop running forward!</p></div><div class=site-nav-toggle><button>
<span class=btn-bar></span><span class=btn-bar></span><span class=btn-bar></span></button></div><nav class=site-nav><ul id=menu class=menu><li class=menu-item><a href=/en/ rel=section><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class=menu-item><a href=/en/post rel=section><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archive</a></li><li class=menu-item><a href=/en/about.html rel=section><i class="menu-item-icon fa fa-fw fa-user"></i><br>About</a></li><li class=menu-item><a href=/en/404.html rel=section target=_blank><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>Page404</a></li><li class="menu-item menu-item-search"><a href=javascript:; class=popup-trigger><i class="menu-item-icon fa fa-search fa-fw"></i><br>Search</a></li></ul><div class=site-search><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class=search-icon><i class="fa fa-search"></i></span><span class=popup-btn-close><i class="fa fa-times-circle"></i></span><div class=local-search-input-wrapper><input autocomplete=off placeholder="Enter key words..." spellcheck=false type=text id=local-search-input autocapitalize=none autocorrect=off></div></div><div id=local-search-result></div></div></div></nav></div></header><main id=main class=main><div class=main-inner><div class=content-wrap><div id=content class=content><section id=posts class=posts-expand><article class="post post-type-normal" itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href=https://lisenhui.cn/en/2012/03/24/java-hard-rsr232.html itemprop=url>Java program and RSR232 serial communication skills</a></h1><div class=post-meta><span class=post-time><i class="fa fa-calendar-o fa-fw"></i><span class=post-meta-item-text>Published at:</span>
<time itemprop=dateCreated datetime=2016-03-22T13:04:35+08:00 content="2012-03-24">2012-03-24</time></span>
<span class=post-category>&nbsp; | &nbsp;
<i class="fa fa-folder-o fa-fw"></i><span class=post-meta-item-text>Categories:</span>
<span itemprop=about itemscope itemtype=https://schema.org/Thing><a href=/en/categories/java itemprop=url rel=index style=text-decoration:underline><span itemprop=name>Java</span></a>
&nbsp;</span></span>
<span>|
<i class="fa fa-file-word-o fa-fw"></i><span class=post-meta-item-text>Words:</span>
<span class=leancloud-world-count>1690 words</span></span>
<span>|
<i class="fa fa-eye fa-fw"></i><span class=post-meta-item-text>Reading:</span>
<span class=leancloud-view-count>8 minutes</span></span>
<span id=/en/2012/03/24/java-hard-rsr232.html class=leancloud_visitors data-flag-title="Java program and RSR232 serial communication skills">|
<i class="fa fa-binoculars fa-fw"></i><span class=post-meta-item-text>Visited:</span>
<span class=leancloud-visitors-count></span></span></div></header><div class=post-body itemprop=articleBody><p>I&rsquo;ve been learning about J2EE application development and never thought about writing hardware interactions with JAVA, but I just like to try something new that I haven&rsquo;t come into contact with. Searched some resources on the Internet, learned that JAVA write serial communication is quite a lot, then began to prepare for the development of debugging environment. Software program development environment is not a problem, but this hardware environment is a bit difficult. Not to mention their own use of notebook where to string ah, and if you really take this string of hardware to their own will not make, then thought of the virtual machine, think this thing should also have a virtual bar, really with their own guesses as there is really this thing, by the way also downloaded a string of small assistant for debugging.</p><p>Here&rsquo;s a look at how the software environment is built:</p><p>:: Download &lsquo;comm.jar&rsquo;, &lsquo;win32com.dll&rsquo; and &lsquo;javax.comm.properties&rsquo;. (Accessories are available for download)
Description: &lsquo;comm.jar&rsquo; provides the java API for communication, &lsquo;win32com.dll&rsquo; provides a local driver interface for &lsquo;comm.jar&rsquo; calls, &lsquo;javax.comm.properties&rsquo; is the class profile for this driver
Copy &lsquo;javacomm.jar&rsquo; to &lsquo;X:\jre\lib\ext&rsquo; directory below;
:: Copy &lsquo;javax.comm.properties&rsquo; to &lsquo;X:\jre.lib&rsquo; directory below;
Copy &lsquo;win32com.dll&rsquo; to &lsquo;X:\jre&rsquo;bin&rsquo; directory below;
:: Update the JDK environment inside the IDE, as shown below:</p><p><img src=http://myblog.lisenhui.cn/2012/03-24-java-hard-rsr232-1.png-alias alt=java-hard-rsr232-1></p><p>Then there is the hardware virtual environment installation virtual serial port, here I use VSPD6.0 (attachment provides download), after installation to start VSPD to add the ports we need, note that here is the way to add by group, such as COM1 and COM2 is a set of simultaneous additions, and so on.</p><p>Once all environments are ready, let&rsquo;s take a quick look at what comm .jar content. From the javadoc of the comm API alone, SUM provides us with only the following 13 classes or interfaces, as follows:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>CommDriver</span>
javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>CommPort</span> javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>ParallelPort</span>
javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>SerialPort</span> javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>CommPortIdentifier</span>
javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>CommPortOwnershipListener</span>
javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>ParallelPortEvent</span> javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>SerialPortEvent</span>
javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>ParallelPortEventListener</span> <span style=color:#666>(</span><span style=color:#a2f;font-weight:700>extends</span> java<span style=color:#666>.</span><span style=color:#b44>util</span><span style=color:#666>.</span><span style=color:#b44>EventListener</span><span style=color:#666>)</span>
javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>SerialPortEventListener</span> <span style=color:#666>(</span><span style=color:#a2f;font-weight:700>extends</span> java<span style=color:#666>.</span><span style=color:#b44>util</span><span style=color:#666>.</span><span style=color:#b44>EventListener</span><span style=color:#666>)</span>
javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>NoSuchPortException</span> javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>PortInUseException</span>
javax<span style=color:#666>.</span><span style=color:#b44>comm</span><span style=color:#666>.</span><span style=color:#b44>UnsupportedCommOperationException</span>
  
</code></pre></div><p>These classes and interfaces named at a glance to know its meaning, do not do a one-to-one introduction, you can go to the official website or the Internet to find more detailed information. Here&rsquo;s a test of whether the built environment is available, with the following main code:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
Enumeration<span style=color:#666>&lt;?&gt;</span> en <span style=color:#666>=</span> CommPortIdentifier<span style=color:#666>.</span><span style=color:#b44>getPortIdentifiers</span><span style=color:#666>();</span>
CommPortIdentifier portId<span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>while</span> <span style=color:#666>(</span>en<span style=color:#666>.</span><span style=color:#b44>hasMoreElements</span><span style=color:#666>())</span> <span style=color:#666>{</span>
  portId <span style=color:#666>(</span>CommPortIdentifier<span style=color:#666>)</span> in<span style=color:#666>.</span><span style=color:#b44>nextElement</span><span style=color:#666>();</span>
  If the port type is serial<span style=color:#666>,</span> its port information is printed
  <span style=color:#00a000>if</span> <span style=color:#666>(</span>portId<span style=color:#666>.</span><span style=color:#b44>getPortType</span><span style=color:#666>()</span> <span style=color:#666>==</span> CommPortIdentifier<span style=color:#666>.</span><span style=color:#b44>PORT_SERIAL</span><span style=color:#666>)</span> <span style=color:#666>{</span>
    System<span style=color:#666>.</span><span style=color:#b44>out</span><span style=color:#666>.</span><span style=color:#b44>println</span><span style=color:#666>(</span>portId<span style=color:#666>.</span><span style=color:#b44>getName</span><span style=color:#666>());</span>
  <span style=color:#666>}</span>
<span style=color:#666>}</span>

</code></pre></div><p>After running the code, the console has the correct port to output (see figure below), indicating that all environments are ok to go down, otherwise check.</p><p><img src=http://myblog.lisenhui.cn/2012/03-24-java-hard-rsr232-2.png-alias alt=java-hard-rsr232-2></p><p>Finally, the problem of interaction with serial data is to be solved. The main difficulty with this is data reading, because we don&rsquo;t know when the port will have data coming or how long it will be. Typically, serial communication applications have two modes, one is to implement the SerialPortEventListener interface, to listen for and handle various serial events, and the other is to establish a separate receiving thread dedicated to receiving data. After referring to the code of many older generations, the following is the first way to write a simple assistant program, the specific implementation of the detailed code, as follows:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java>
<span style=color:#a2f;font-weight:700>package</span> <span style=color:#00f;font-weight:700>com.elkan1788.view</span><span style=color:#666>;</span>

<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.awt.BorderLayout</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.awt.Button</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.awt.Color</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.awt.Font</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.awt.GridLayout</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.awt.Image</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.awt.TextArea</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.awt.TextField</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.awt.event.ActionEvent</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.awt.event.ActionListener</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.io.IOException</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.io.InputStream</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.io.OutputStream</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.util.ArrayList</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.util.Enumeration</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.util.List</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>java.util.TooManyListenersException</span><span style=color:#666>;</span>

<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.comm.CommPortIdentifier</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.comm.NoSuchPortException</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.comm.PortInUseException</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.comm.SerialPort</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.comm.SerialPortEvent</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.comm.SerialPortEventListener</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.comm.UnsupportedCommOperationException</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.imageio.ImageIO</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.swing.JComboBox</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.swing.JFrame</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.swing.JLabel</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.swing.JOptionPane</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.swing.JPanel</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.swing.SwingConstants</span><span style=color:#666>;</span>
<span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>javax.swing.border.EmptyBorder</span><span style=color:#666>;</span>

<span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>JavaRs232</span> <span style=color:#a2f;font-weight:700>extends</span> JFrame <span style=color:#a2f;font-weight:700>implements</span> ActionListener<span style=color:#666>,</span> SerialPortEventListener <span style=color:#666>{</span>

  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   * JDK Serial Version UID
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>private</span> <span style=color:#a2f;font-weight:700>static</span> <span style=color:#a2f;font-weight:700>final</span> <span style=color:#0b0;font-weight:700>long</span> serialVersionUID <span style=color:#666>=</span> <span style=color:#666>-</span>7270865686330790103L<span style=color:#666>;</span>

  <span style=color:#a2f;font-weight:700>protected</span> <span style=color:#0b0;font-weight:700>int</span> WIN_WIDTH <span style=color:#666>=</span> 380<span style=color:#666>;</span>
  
  <span style=color:#a2f;font-weight:700>protected</span> <span style=color:#0b0;font-weight:700>int</span> WIN_HEIGHT <span style=color:#666>=</span> 300<span style=color:#666>;</span>
  
  <span style=color:#a2f;font-weight:700>private</span> JComboBox<span style=color:#666>&lt;?&gt;</span> portCombox<span style=color:#666>,</span> rateCombox<span style=color:#666>,</span> dataCombox<span style=color:#666>,</span> stopCombox<span style=color:#666>,</span> parityCombox<span style=color:#666>;</span> 
  
  <span style=color:#a2f;font-weight:700>private</span> Button openPortBtn<span style=color:#666>,</span> closePortBtn<span style=color:#666>,</span> sendMsgBtn<span style=color:#666>;</span>
  
  <span style=color:#a2f;font-weight:700>private</span> TextField sendTf<span style=color:#666>;</span>
  
  <span style=color:#a2f;font-weight:700>private</span> TextArea readTa<span style=color:#666>;</span>
  
  <span style=color:#a2f;font-weight:700>private</span> JLabel statusLb<span style=color:#666>;</span>
  
  <span style=color:#a2f;font-weight:700>private</span> String portname<span style=color:#666>,</span> rate<span style=color:#666>,</span> data<span style=color:#666>,</span> stop<span style=color:#666>,</span> parity<span style=color:#666>;</span>
  
  <span style=color:#a2f;font-weight:700>protected</span> CommPortIdentifier portId<span style=color:#666>;</span>
  
  <span style=color:#a2f;font-weight:700>protected</span> Enumeration<span style=color:#666>&lt;?&gt;</span> ports<span style=color:#666>;</span>
  
  <span style=color:#a2f;font-weight:700>protected</span> List<span style=color:#666>&lt;</span>String<span style=color:#666>&gt;</span> portList<span style=color:#666>;</span>

  <span style=color:#a2f;font-weight:700>protected</span> SerialPort serialPort<span style=color:#666>;</span>

  <span style=color:#a2f;font-weight:700>protected</span> OutputStream outputStream <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>null</span><span style=color:#666>;</span> 

  <span style=color:#a2f;font-weight:700>protected</span> InputStream inputStream <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>null</span><span style=color:#666>;</span> 
    
  <span style=color:#a2f;font-weight:700>protected</span> String mesg<span style=color:#666>;</span>
    
  <span style=color:#a2f;font-weight:700>protected</span> <span style=color:#0b0;font-weight:700>int</span> sendCount<span style=color:#666>,</span> reciveCount<span style=color:#666>;</span>
  
    <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>     The default constructor
</span><span style=color:#080;font-style:italic>     */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#00a000>JavaRs232</span><span style=color:#666>()</span> <span style=color:#666>{</span>    
    <span style=color:#a2f;font-weight:700>super</span> <span style=color:#666>(</span><span style=color:#b44>&#34;Java RS-232 serial communication test program Van Dream Stardust&#34;</span><span style=color:#666>);</span>
    setSize<span style=color:#666>(</span>WIN_WIDTH<span style=color:#666>,</span> WIN_HEIGHT<span style=color:#666>);</span>
    setLocationRelativeTo<span style=color:#666>(</span><span style=color:#a2f;font-weight:700>null</span><span style=color:#666>);</span>
    Image icon <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>null</span><span style=color:#666>;</span>
    <span style=color:#a2f;font-weight:700>try</span> <span style=color:#666>{</span>
      icon <span style=color:#666>=</span> ImageIO<span style=color:#666>.</span><span style=color:#b44>read</span><span style=color:#666>(</span>JavaRs232<span style=color:#666>.</span><span style=color:#b44>class</span><span style=color:#666>.</span><span style=color:#b44>getResourceAsStream</span><span style=color:#666>(</span><span style=color:#b44>&#34;/res/rs232.png&#34;</span><span style=color:#666>));</span>
    <span style=color:#666>}</span> <span style=color:#a2f;font-weight:700>catch</span> <span style=color:#666>(</span>IOException e<span style=color:#666>)</span> <span style=color:#666>{</span>
      showErrMesgbox<span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getMessage</span><span style=color:#666>());</span>
    <span style=color:#666>}</span>
    setIconImage<span style=color:#666>(</span>icon<span style=color:#666>);</span>
    setResizable<span style=color:#666>(</span><span style=color:#a2f;font-weight:700>false</span><span style=color:#666>);</span>
    scanPorts<span style=color:#666>();</span>
    initComponents<span style=color:#666>();</span>
    setDefaultCloseOperation<span style=color:#666>(</span>JFrame<span style=color:#666>.</span><span style=color:#b44>EXIT_ON_CLOSE</span><span style=color:#666>);</span>
    setVisible<span style=color:#666>(</span><span style=color:#a2f;font-weight:700>true</span><span style=color:#666>);</span>
  <span style=color:#666>}</span>
  
  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   Initialize each UI component
</span><span style=color:#080;font-style:italic>   :: @since March 22, 2012 11:56:39 PM
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>initComponents</span><span style=color:#666>()</span> <span style=color:#666>{</span>    
    Shared constants
    Font lbFont <span style=color:#666>-</span> <span style=color:#a2f;font-weight:700>new</span> Font <span style=color:#666>(</span><span style=color:#b44>&#34;Microsoft Ya black,&#34;</span> Font<span style=color:#666>.</span><span style=color:#b44>TRUETYPE_FONT</span><span style=color:#666>,</span> 14<span style=color:#666>);</span>

    Create the left panel
    JPanel northPane <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> JPanel<span style=color:#666>();</span>
    northPane<span style=color:#666>.</span><span style=color:#b44>setLayout</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>new</span> GridLayout<span style=color:#666>(</span>1<span style=color:#666>,</span> 1<span style=color:#666>));</span>
    Set the components of the left panel
    JPanel leftPane <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> JPanel<span style=color:#666>();</span>   
    leftPane<span style=color:#666>.</span><span style=color:#b44>setOpaque</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>false</span><span style=color:#666>);</span>
    leftPane<span style=color:#666>.</span><span style=color:#b44>setLayout</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>new</span> GridLayout<span style=color:#666>(</span>3<span style=color:#666>,</span>2<span style=color:#666>));</span>
    JLabel portnameLb <span style=color:#666>-</span> <span style=color:#a2f;font-weight:700>new</span> JLabel <span style=color:#666>(</span><span style=color:#b44>&#34;Serial slogan:&#34;</span>
    portnameLb<span style=color:#666>.</span><span style=color:#b44>setFont</span><span style=color:#666>(</span>lbFont<span style=color:#666>);</span>
    portnameLb<span style=color:#666>.</span><span style=color:#b44>setHorizontalAlignment</span><span style=color:#666>(</span>SwingConstants<span style=color:#666>.</span><span style=color:#b44>RIGHT</span><span style=color:#666>);</span>
    portCombox <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> JComboBox<span style=color:#666>&lt;</span>String<span style=color:#666>&gt;((</span>String <span style=color:#666>[])</span>portList<span style=color:#666>.</span><span style=color:#b44>toArray</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>new</span> String<span style=color:#666>[</span>0<span style=color:#666>]));</span>
    portCombox<span style=color:#666>.</span><span style=color:#b44>addActionListener</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span>
    JLabel databitsLb <span style=color:#666>-</span> <span style=color:#a2f;font-weight:700>new</span> JLabel <span style=color:#666>(</span><span style=color:#b44>&#34;data bit:&#34;</span><span style=color:#666>);</span>
    databitsLb<span style=color:#666>.</span><span style=color:#b44>setFont</span><span style=color:#666>(</span>lbFont<span style=color:#666>);</span>
    databitsLb<span style=color:#666>.</span><span style=color:#b44>setHorizontalAlignment</span><span style=color:#666>(</span>SwingConstants<span style=color:#666>.</span><span style=color:#b44>RIGHT</span><span style=color:#666>);</span>
    dataCombox <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> JComboBox<span style=color:#666>&lt;</span>Integer<span style=color:#666>&gt;(</span><span style=color:#a2f;font-weight:700>new</span> Integer<span style=color:#666>[]{</span>5<span style=color:#666>,</span> 6<span style=color:#666>,</span> 7<span style=color:#666>,</span> 8<span style=color:#666>});</span>
    dataCombox<span style=color:#666>.</span><span style=color:#b44>setSelectedIndex</span><span style=color:#666>(</span>3<span style=color:#666>);</span>
    dataCombox<span style=color:#666>.</span><span style=color:#b44>addActionListener</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span>
    JLabel ParityLb <span style=color:#666>-</span> <span style=color:#a2f;font-weight:700>new</span> JLabel <span style=color:#666>(</span><span style=color:#b44>&#34;Check bit:&#34;</span><span style=color:#666>);</span>
    parityLb<span style=color:#666>.</span><span style=color:#b44>setFont</span><span style=color:#666>(</span>lbFont<span style=color:#666>);</span>
    parityLb<span style=color:#666>.</span><span style=color:#b44>setHorizontalAlignment</span><span style=color:#666>(</span>SwingConstants<span style=color:#666>.</span><span style=color:#b44>RIGHT</span><span style=color:#666>);</span>
    parityCombox <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> JComboBox<span style=color:#666>&lt;</span>String<span style=color:#666>&gt;(</span><span style=color:#a2f;font-weight:700>new</span> String<span style=color:#666>[]{</span><span style=color:#b44>&#34;NONE&#34;</span><span style=color:#666>,</span><span style=color:#b44>&#34;ODD&#34;</span><span style=color:#666>,</span><span style=color:#b44>&#34;EVEN&#34;</span><span style=color:#666>,</span><span style=color:#b44>&#34;MARK&#34;</span><span style=color:#666>,</span><span style=color:#b44>&#34;SPACE&#34;</span><span style=color:#666>});</span>
    parityCombox<span style=color:#666>.</span><span style=color:#b44>addActionListener</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span>
    Add components to the panel
    leftPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>portnameLb<span style=color:#666>);</span>
    leftPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>portCombox<span style=color:#666>);</span>
    leftPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>databitsLb<span style=color:#666>);</span>
    leftPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>dataCombox<span style=color:#666>);</span>
    leftPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>parityLb<span style=color:#666>);</span>
    leftPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>parityCombox<span style=color:#666>);</span>

    Create the right panel
    JPanel rightPane <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> JPanel<span style=color:#666>();</span>
    rightPane<span style=color:#666>.</span><span style=color:#b44>setLayout</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>new</span> GridLayout<span style=color:#666>(</span>3<span style=color:#666>,</span>2<span style=color:#666>));</span>
    Set the components of the right panel
    JLabel BaudrateLb <span style=color:#666>-</span> <span style=color:#a2f;font-weight:700>new</span> JLabel <span style=color:#666>(</span><span style=color:#b44>&#34;Porter rate:&#34;</span><span style=color:#666>);</span>
    baudrateLb<span style=color:#666>.</span><span style=color:#b44>setFont</span><span style=color:#666>(</span>lbFont<span style=color:#666>);</span>
    baudrateLb<span style=color:#666>.</span><span style=color:#b44>setHorizontalAlignment</span><span style=color:#666>(</span>SwingConstants<span style=color:#666>.</span><span style=color:#b44>RIGHT</span><span style=color:#666>);</span>
    rateCombox <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> JComboBox<span style=color:#666>&lt;</span>Integer<span style=color:#666>&gt;(</span><span style=color:#a2f;font-weight:700>new</span> Integer<span style=color:#666>[]{</span>2400<span style=color:#666>,</span>4800<span style=color:#666>,</span>9600<span style=color:#666>,</span>14400<span style=color:#666>,</span>19200<span style=color:#666>,</span>38400<span style=color:#666>,</span>56000<span style=color:#666>});</span>
    rateCombox<span style=color:#666>.</span><span style=color:#b44>setSelectedIndex</span><span style=color:#666>(</span>2<span style=color:#666>);</span>
    rateCombox<span style=color:#666>.</span><span style=color:#b44>addActionListener</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span>
    JLabel stopbitsLb s <span style=color:#a2f;font-weight:700>new</span> <span style=color:#00a000>JLabel</span> <span style=color:#666>(</span><span style=color:#b44>&#34;stop bit:&#34;</span><span style=color:#666>);</span>
    stopbitsLb<span style=color:#666>.</span><span style=color:#b44>setFont</span><span style=color:#666>(</span>lbFont<span style=color:#666>);</span>
    stopbitsLb<span style=color:#666>.</span><span style=color:#b44>setHorizontalAlignment</span><span style=color:#666>(</span>SwingConstants<span style=color:#666>.</span><span style=color:#b44>RIGHT</span><span style=color:#666>);</span>
    stopCombox <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> JComboBox<span style=color:#666>&lt;</span>String<span style=color:#666>&gt;(</span><span style=color:#a2f;font-weight:700>new</span> String<span style=color:#666>[]{</span><span style=color:#b44>&#34;1&#34;</span><span style=color:#666>,</span><span style=color:#b44>&#34;2&#34;</span><span style=color:#666>,</span><span style=color:#b44>&#34;1.5&#34;</span><span style=color:#666>});</span>
    stopCombox<span style=color:#666>.</span><span style=color:#b44>addActionListener</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span>
    openPortBtn <span style=color:#666>-</span> <span style=color:#a2f;font-weight:700>new</span> Button <span style=color:#666>(</span><span style=color:#b44>&#34;Open Port&#34;</span><span style=color:#666>);</span>
    openPortBtn<span style=color:#666>.</span><span style=color:#b44>addActionListener</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span>
    closePortBtn <span style=color:#666>-</span> <span style=color:#a2f;font-weight:700>new</span> Button <span style=color:#666>(</span><span style=color:#b44>&#34;close port&#34;</span><span style=color:#666>);</span> 
    closePortBtn<span style=color:#666>.</span><span style=color:#b44>addActionListener</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span>
    Add components to the panel
    rightPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>baudrateLb<span style=color:#666>);</span>
    rightPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>rateCombox<span style=color:#666>);</span>
    rightPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>stopbitsLb<span style=color:#666>);</span>
    rightPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>stopCombox<span style=color:#666>);</span>
    rightPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>openPortBtn<span style=color:#666>);</span>
    rightPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>closePortBtn<span style=color:#666>);</span>
    Add the left and right panel combinations to the north panel
    northPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>leftPane<span style=color:#666>);</span>
    northPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>rightPane<span style=color:#666>);</span>

    Create an intermediate panel
    JPanel centerPane <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> JPanel<span style=color:#666>();</span>
    Set up the components of the middle panel
    sendTf <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> TextField<span style=color:#666>(</span>42<span style=color:#666>);</span>
    readTa <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> TextArea<span style=color:#666>(</span>8<span style=color:#666>,</span>50<span style=color:#666>);</span>
    readTa<span style=color:#666>.</span><span style=color:#b44>setEditable</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>false</span><span style=color:#666>);</span>
    readTa<span style=color:#666>.</span><span style=color:#b44>setBackground</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>new</span> Color<span style=color:#666>(</span>225<span style=color:#666>,</span>242<span style=color:#666>,</span>250<span style=color:#666>));</span>
    centerPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>sendTf<span style=color:#666>);</span>
    sendMsgBtn <span style=color:#666>-</span> <span style=color:#a2f;font-weight:700>new</span> Button <span style=color:#666>(</span><span style=color:#b44>&#34;Send&#34;</span><span style=color:#666>);</span>
    sendMsgBtn<span style=color:#666>.</span><span style=color:#b44>addActionListener</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span>
    Add components to the panel
    centerPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>sendTf<span style=color:#666>);</span>
    centerPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>sendMsgBtn<span style=color:#666>);</span>
    centerPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>readTa<span style=color:#666>);</span>
    
    Set up the south component
    statusLb <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> JLabel<span style=color:#666>();</span>
    statusLb<span style=color:#666>.</span><span style=color:#b44>setText</span><span style=color:#666>(</span>initStatus<span style=color:#666>());</span>
    statusLb<span style=color:#666>.</span><span style=color:#b44>setOpaque</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>true</span><span style=color:#666>);</span>
    
    Gets the container <span style=color:#a2f;font-weight:700>for</span> the main form and consolidates the layout north<span style=color:#666>,</span> middle<span style=color:#666>,</span> and south of the three panels above
    JPanel contentPane <span style=color:#666>=</span> <span style=color:#666>(</span>JPanel<span style=color:#666>)</span>getContentPane<span style=color:#666>();</span>
    contentPane<span style=color:#666>.</span><span style=color:#b44>setLayout</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>new</span> BorderLayout<span style=color:#666>());</span>
    contentPane<span style=color:#666>.</span><span style=color:#b44>setBorder</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>new</span> EmptyBorder<span style=color:#666>(</span>0<span style=color:#666>,</span> 0<span style=color:#666>,</span> 0<span style=color:#666>,</span> 0<span style=color:#666>));</span>
    contentPane<span style=color:#666>.</span><span style=color:#b44>setOpaque</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>false</span><span style=color:#666>);</span>
    contentPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>northPane<span style=color:#666>,</span> BorderLayout<span style=color:#666>.</span><span style=color:#b44>NORTH</span><span style=color:#666>);</span>
    contentPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>centerPane<span style=color:#666>,</span> BorderLayout<span style=color:#666>.</span><span style=color:#b44>CENTER</span><span style=color:#666>);</span>
    contentPane<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>statusLb<span style=color:#666>,</span> BorderLayout<span style=color:#666>.</span><span style=color:#b44>SOUTH</span><span style=color:#666>);</span>
  <span style=color:#666>}</span>
  
  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   The initialization status label displays text
</span><span style=color:#080;font-style:italic>   * @return String
</span><span style=color:#080;font-style:italic>   :: @since March 23, 2012 12:01:53 AM
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> String <span style=color:#00a000>initStatus</span><span style=color:#666>()</span> <span style=color:#666>{</span>
    portname <span style=color:#666>=</span> portCombox<span style=color:#666>.</span><span style=color:#b44>getSelectedItem</span><span style=color:#666>().</span><span style=color:#b44>toString</span><span style=color:#666>();</span>
    rate <span style=color:#666>=</span> rateCombox<span style=color:#666>.</span><span style=color:#b44>getSelectedItem</span><span style=color:#666>().</span><span style=color:#b44>toString</span><span style=color:#666>();</span>
    data <span style=color:#666>=</span> dataCombox<span style=color:#666>.</span><span style=color:#b44>getSelectedItem</span><span style=color:#666>().</span><span style=color:#b44>toString</span><span style=color:#666>();</span>
    stop <span style=color:#666>=</span> stopCombox<span style=color:#666>.</span><span style=color:#b44>getSelectedItem</span><span style=color:#666>().</span><span style=color:#b44>toString</span><span style=color:#666>();</span>
    parity <span style=color:#666>=</span> parityCombox<span style=color:#666>.</span><span style=color:#b44>getSelectedItem</span><span style=color:#666>().</span><span style=color:#b44>toString</span><span style=color:#666>();</span>
    
    StringBuffer str <span style=color:#666>-</span> <span style=color:#a2f;font-weight:700>new</span> String <span style=color:#00a000>Buffer</span> <span style=color:#666>(</span><span style=color:#b44>&#34;Current string slogan:&#34;</span>
    str<span style=color:#666>.</span><span style=color:#b44>append</span> <span style=color:#666>(</span>portname<span style=color:#666>).</span><span style=color:#b44>append</span> <span style=color:#666>(</span><span style=color:#b44>&#34;porter rate:&#34;</span><span style=color:#666>);</span>
    str<span style=color:#666>.</span><span style=color:#b44>append</span> <span style=color:#666>(</span>rate<span style=color:#666>).</span><span style=color:#b44>append</span> <span style=color:#666>(</span><span style=color:#b44>&#34;data bit:&#34;</span><span style=color:#666>);</span>
    str<span style=color:#666>.</span><span style=color:#b44>append</span> <span style=color:#666>(</span>data<span style=color:#666>.</span><span style=color:#b44>append</span> <span style=color:#666>(</span><span style=color:#b44>&#34;stop bit&#34;</span><span style=color:#666>);</span>
    str<span style=color:#666>.</span><span style=color:#b44>append</span> <span style=color:#666>(</span>stop<span style=color:#666>.</span><span style=color:#b44>append</span><span style=color:#666>(</span><span style=color:#b44>&#34;check bit:&#34;</span><span style=color:#666>);</span>
    str<span style=color:#666>.</span><span style=color:#b44>append</span><span style=color:#666>(</span>parity<span style=color:#666>);</span>
    <span style=color:#a2f;font-weight:700>return</span> str<span style=color:#666>.</span><span style=color:#b44>toString</span><span style=color:#666>();</span>
  <span style=color:#666>}</span>
  
  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   :: Scan all COM ports on this machine
</span><span style=color:#080;font-style:italic>   :: @since March 23, 2012 12:02:42 AM
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>scanPorts</span><span style=color:#666>()</span> <span style=color:#666>{</span>
    portList <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> ArrayList<span style=color:#666>&lt;</span>String<span style=color:#666>&gt;();</span>
    Enumeration<span style=color:#666>&lt;?&gt;</span> en <span style=color:#666>=</span> CommPortIdentifier<span style=color:#666>.</span><span style=color:#b44>getPortIdentifiers</span><span style=color:#666>();</span>
    CommPortIdentifier portId<span style=color:#666>;</span>
    <span style=color:#a2f;font-weight:700>while</span><span style=color:#666>(</span>en<span style=color:#666>.</span><span style=color:#b44>hasMoreElements</span><span style=color:#666>()){</span>
      portId <span style=color:#666>(</span>CommPortIdentifier<span style=color:#666>)</span> in<span style=color:#666>.</span><span style=color:#b44>nextElement</span><span style=color:#666>();</span>
      <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span>portId<span style=color:#666>.</span><span style=color:#b44>getPortType</span><span style=color:#666>()</span> <span style=color:#666>==</span> CommPortIdentifier<span style=color:#666>.</span><span style=color:#b44>PORT_SERIAL</span><span style=color:#666>){</span>
        String name <span style=color:#666>=</span> portId<span style=color:#666>.</span><span style=color:#b44>getName</span><span style=color:#666>();</span>
        <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(!</span>portList<span style=color:#666>.</span><span style=color:#b44>contains</span><span style=color:#666>(</span>name<span style=color:#666>))</span> <span style=color:#666>{</span>
          portList<span style=color:#666>.</span><span style=color:#b44>add</span><span style=color:#666>(</span>name<span style=color:#666>);</span>
        <span style=color:#666>}</span>
      <span style=color:#666>}</span>
    <span style=color:#666>}</span>
    <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>null</span> <span style=color:#666>==</span> portList 
        <span style=color:#666>||</span> portList<span style=color:#666>.</span><span style=color:#b44>isEmpty</span><span style=color:#666>())</span> <span style=color:#666>{</span>
      ShowErrMesgbox <span style=color:#666>(</span><span style=color:#b44>&#34;No available serial port number found, program cannot start!&#34;</span><span style=color:#666>);</span>
      System<span style=color:#666>.</span><span style=color:#b44>exit</span><span style=color:#666>(</span>0<span style=color:#666>);</span>
    <span style=color:#666>}</span>
  <span style=color:#666>}</span>
  
  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   Open the serial port
</span><span style=color:#080;font-style:italic>   :: @since 2012-3-23 at 12:03:07 AM
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>openSerialPort</span><span style=color:#666>()</span> <span style=color:#666>{</span> 
    Gets the port you want to open
    <span style=color:#a2f;font-weight:700>try</span> <span style=color:#666>{</span>
      portId <span style=color:#666>=</span> CommPortIdentifier<span style=color:#666>.</span><span style=color:#b44>getPortIdentifier</span><span style=color:#666>(</span>portname<span style=color:#666>);</span>
    <span style=color:#666>}</span> <span style=color:#a2f;font-weight:700>catch</span> <span style=color:#666>(</span>NoSuchPortException e<span style=color:#666>)</span> <span style=color:#666>{</span>
      showErrMesgbox <span style=color:#666>(</span><span style=color:#b44>&#34;Sorry, I didn&#39;t find the serial port number&#34;</span><span style=color:#666>);</span>
      setComponentsEnabled<span style=color:#666>(</span><span style=color:#a2f;font-weight:700>true</span><span style=color:#666>);</span>
      <span style=color:#a2f;font-weight:700>return</span> <span style=color:#666>;</span>
    <span style=color:#666>}</span>
    Open the port
    <span style=color:#a2f;font-weight:700>try</span> <span style=color:#666>{</span>
      serialPort <span style=color:#666>=</span> <span style=color:#666>(</span>SerialPort<span style=color:#666>)</span> portId<span style=color:#666>.</span><span style=color:#b44>open</span><span style=color:#666>(</span><span style=color:#b44>&#34;JavaRs232&#34;</span><span style=color:#666>,</span> 2000<span style=color:#666>);</span>
      statusLb<span style=color:#666>.</span><span style=color:#b44>setText</span> <span style=color:#666>(</span>portname plus <span style=color:#b44>&#34;serial port is open!&#34;</span><span style=color:#666>);</span>
    <span style=color:#666>}</span> <span style=color:#a2f;font-weight:700>catch</span> <span style=color:#666>(</span>PortInUseException e<span style=color:#666>)</span> <span style=color:#666>{</span>
      ShowErrMesgbox <span style=color:#666>(</span>portname plus <span style=color:#b44>&#34;ports are occupied, please check!&#34;</span><span style=color:#666>);</span>
      setComponentsEnabled<span style=color:#666>(</span><span style=color:#a2f;font-weight:700>true</span><span style=color:#666>);</span>
      <span style=color:#a2f;font-weight:700>return</span> <span style=color:#666>;</span>
    <span style=color:#666>}</span>
    
    Set the port parameters
    <span style=color:#a2f;font-weight:700>try</span> <span style=color:#666>{</span>
      <span style=color:#0b0;font-weight:700>int</span> rate <span style=color:#666>=</span> Integer<span style=color:#666>.</span><span style=color:#b44>parseInt</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>rate</span><span style=color:#666>);</span>
      <span style=color:#0b0;font-weight:700>int</span> data <span style=color:#666>=</span> Integer<span style=color:#666>.</span><span style=color:#b44>parseInt</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>.</span><span style=color:#b44>data</span><span style=color:#666>);</span>
      <span style=color:#0b0;font-weight:700>int</span> stop <span style=color:#666>=</span> stopCombox<span style=color:#666>.</span><span style=color:#b44>getSelectedIndex</span><span style=color:#666>()+</span>1<span style=color:#666>;</span>
      <span style=color:#0b0;font-weight:700>int</span> parity <span style=color:#666>=</span> parityCombox<span style=color:#666>.</span><span style=color:#b44>getSelectedIndex</span><span style=color:#666>();</span>
      serialPort<span style=color:#666>.</span><span style=color:#b44>setSerialPortParams</span><span style=color:#666>(</span>rate<span style=color:#666>,</span>data<span style=color:#666>,</span>stop<span style=color:#666>,</span>parity<span style=color:#666>);</span>
    <span style=color:#666>}</span> <span style=color:#a2f;font-weight:700>catch</span> <span style=color:#666>(</span>UnsupportedCommOperationException e<span style=color:#666>)</span> <span style=color:#666>{</span>
      showErrMesgbox<span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getMessage</span><span style=color:#666>());</span>
    <span style=color:#666>}</span>

    Open the port<span>&#39;</span>s IO flow pipeline 
    <span style=color:#a2f;font-weight:700>try</span> <span style=color:#666>{</span> 
      outputStream <span style=color:#666>=</span> serialPort<span style=color:#666>.</span><span style=color:#b44>getOutputStream</span><span style=color:#666>();</span> 
      inputStream <span style=color:#666>=</span> serialPort<span style=color:#666>.</span><span style=color:#b44>getInputStream</span><span style=color:#666>();</span> 
    <span style=color:#666>}</span> <span style=color:#a2f;font-weight:700>catch</span> <span style=color:#666>(</span>IOException e<span style=color:#666>)</span> <span style=color:#666>{</span>
      showErrMesgbox<span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getMessage</span><span style=color:#666>());</span>
    <span style=color:#666>}</span> 

    Add a listener to the port
    <span style=color:#a2f;font-weight:700>try</span> <span style=color:#666>{</span> 
      serialPort<span style=color:#666>.</span><span style=color:#b44>addEventListener</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>);</span> 
    <span style=color:#666>}</span> <span style=color:#a2f;font-weight:700>catch</span> <span style=color:#666>(</span>TooManyListenersException e<span style=color:#666>)</span> <span style=color:#666>{</span>
      showErrMesgbox<span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getMessage</span><span style=color:#666>());</span>
    <span style=color:#666>}</span> 

    serialPort<span style=color:#666>.</span><span style=color:#b44>notifyOnDataAvailable</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>true</span><span style=color:#666>);</span> 
  <span style=color:#666>}</span> 
  
  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   Send data to the serial port
</span><span style=color:#080;font-style:italic>   :: @since 2012-3-23 at 12:05:00 AM
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>sendDataToSeriaPort</span><span style=color:#666>()</span> <span style=color:#666>{</span> 
    <span style=color:#a2f;font-weight:700>try</span> <span style=color:#666>{</span> 
      sendCount<span style=color:#666>++;</span>
      outputStream<span style=color:#666>.</span><span style=color:#b44>write</span><span style=color:#666>(</span>mesg<span style=color:#666>.</span><span style=color:#b44>getBytes</span><span style=color:#666>());</span> 
      outputStream<span style=color:#666>.</span><span style=color:#b44>flush</span><span style=color:#666>();</span> 

    <span style=color:#666>}</span> <span style=color:#a2f;font-weight:700>catch</span> <span style=color:#666>(</span>IOException e<span style=color:#666>)</span> <span style=color:#666>{</span> 
      showErrMesgbox<span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getMessage</span><span style=color:#666>());</span>
    <span style=color:#666>}</span> 
    
    statusLb<span style=color:#666>.</span><span style=color:#b44>setText</span> <span style=color:#666>(</span><span style=color:#b44>&#34;Send: &#34;</span>sendCount plus<span style=color:#b44>&#34; receive: &#34;&#34;-reciveCount&#34;</span><span style=color:#666>);</span>
  <span style=color:#666>}</span> 
  
  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   :: Close the serial port
</span><span style=color:#080;font-style:italic>   :: @since 2012-3-23 at 12:05:28 AM
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>closeSerialPort</span><span style=color:#666>()</span> <span style=color:#666>{</span> 
    <span style=color:#a2f;font-weight:700>try</span> <span style=color:#666>{</span> 
      <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span>outputStream <span style=color:#666>!=</span> <span style=color:#a2f;font-weight:700>null</span><span style=color:#666>)</span>
        outputStream<span style=color:#666>.</span><span style=color:#b44>close</span><span style=color:#666>();</span>
      <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span>serialPort <span style=color:#666>!=</span> <span style=color:#a2f;font-weight:700>null</span><span style=color:#666>)</span>
        serialPort<span style=color:#666>.</span><span style=color:#b44>close</span><span style=color:#666>();</span> 
      serialPort <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>null</span><span style=color:#666>;</span>
      statusLb<span style=color:#666>.</span><span style=color:#b44>setText</span> <span style=color:#666>(</span>portname plus <span style=color:#b44>&#34;serial port is closed!&#34;</span><span style=color:#666>);</span>
      sendCount <span style=color:#666>=</span> 0<span style=color:#666>;</span>
      reciveCount <span style=color:#666>=</span> 0<span style=color:#666>;</span>
      sendTf<span style=color:#666>.</span><span style=color:#b44>setText</span><span style=color:#666>(</span><span style=color:#b44>&#34;&#34;</span><span style=color:#666>);</span>
      readTa<span style=color:#666>.</span><span style=color:#b44>setText</span><span style=color:#666>(</span><span style=color:#b44>&#34;&#34;</span><span style=color:#666>);</span>
    <span style=color:#666>}</span> <span style=color:#a2f;font-weight:700>catch</span> <span style=color:#666>(</span>Exception e<span style=color:#666>)</span> <span style=color:#666>{</span> 
      showErrMesgbox<span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getMessage</span><span style=color:#666>());</span>
    <span style=color:#666>}</span> 
  <span style=color:#666>}</span>   
  
  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   :: Display an error or warning message
</span><span style=color:#080;font-style:italic>   :: @param msg information
</span><span style=color:#080;font-style:italic>   :: @since March 23, 2012 12:05:47 AM
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>showErrMesgbox</span><span style=color:#666>(</span>String msg<span style=color:#666>)</span> <span style=color:#666>{</span>
    JOptionPane<span style=color:#666>.</span><span style=color:#b44>showMessageDialog</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>this</span><span style=color:#666>,</span> msg<span style=color:#666>);</span>
  <span style=color:#666>}</span>

  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   :: Each component behavior event listens
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>actionPerformed</span><span style=color:#666>(</span>ActionEvent e<span style=color:#666>)</span> <span style=color:#666>{</span>
    <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getSource</span><span style=color:#666>()</span> <span style=color:#666>==</span> portCombox
        <span style=color:#666>||</span> e<span style=color:#666>.</span><span style=color:#b44>getSource</span><span style=color:#666>()</span> <span style=color:#666>==</span> rateCombox
        <span style=color:#666>||</span> e<span style=color:#666>.</span><span style=color:#b44>getSource</span><span style=color:#666>()</span> <span style=color:#666>==</span> dataCombox
        <span style=color:#666>||</span> e<span style=color:#666>.</span><span style=color:#b44>getSource</span><span style=color:#666>()</span> <span style=color:#666>==</span> stopCombox
        <span style=color:#666>||</span> e<span style=color:#666>.</span><span style=color:#b44>getSource</span><span style=color:#666>()</span> <span style=color:#666>==</span> parityCombox<span style=color:#666>){</span>
      statusLb<span style=color:#666>.</span><span style=color:#b44>setText</span><span style=color:#666>(</span>initStatus<span style=color:#666>());</span>
    <span style=color:#666>}</span>
    <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getSource</span><span style=color:#666>()</span> <span style=color:#666>==</span> openPortBtn<span style=color:#666>){</span>
      setComponentsEnabled<span style=color:#666>(</span><span style=color:#a2f;font-weight:700>false</span><span style=color:#666>);</span>      
      openSerialPort<span style=color:#666>();</span>
    <span style=color:#666>}</span>
    <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getSource</span><span style=color:#666>()</span> <span style=color:#666>==</span> closePortBtn<span style=color:#666>){</span>
      <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span>serialPort <span style=color:#666>!=</span> <span style=color:#a2f;font-weight:700>null</span><span style=color:#666>){</span>
        closeSerialPort<span style=color:#666>();</span>
      <span style=color:#666>}</span>
      setComponentsEnabled<span style=color:#666>(</span><span style=color:#a2f;font-weight:700>true</span><span style=color:#666>);</span>
    <span style=color:#666>}</span>
    
    <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getSource</span><span style=color:#666>()</span> <span style=color:#666>==</span> sendMsgBtn<span style=color:#666>){</span>
      <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span>serialPort <span style=color:#666>==</span> <span style=color:#a2f;font-weight:700>null</span><span style=color:#666>){</span>
        ShowErrMesgbox <span style=color:#666>(</span><span style=color:#b44>&#34;Please open the serial port first!&#34;</span><span style=color:#666>);</span>
        <span style=color:#a2f;font-weight:700>return</span> <span style=color:#666>;</span>
      <span style=color:#666>}</span>
      mesg <span style=color:#666>=</span> sendTf<span style=color:#666>.</span><span style=color:#b44>getText</span><span style=color:#666>();</span>
      <span style=color:#a2f;font-weight:700>if</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>null</span> <span style=color:#666>==</span> mesg <span style=color:#666>||</span> mesg<span style=color:#666>.</span><span style=color:#b44>isEmpty</span><span style=color:#666>()){</span>
        ShowErrMesgbox <span style=color:#666>(</span><span style=color:#b44>&#34;Please enter what you want to send!&#34;</span><span style=color:#666>);</span>
        <span style=color:#a2f;font-weight:700>return</span> <span style=color:#666>;</span>
      <span style=color:#666>}</span>
      sendDataToSeriaPort<span style=color:#666>();</span>
    <span style=color:#666>}</span>
  <span style=color:#666>}</span>

  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   :: Port event monitoring
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>serialEvent</span><span style=color:#666>(</span>SerialPortEvent event<span style=color:#666>)</span> <span style=color:#666>{</span>
    <span style=color:#a2f;font-weight:700>switch</span> <span style=color:#666>(</span>event<span style=color:#666>.</span><span style=color:#b44>getEventType</span><span style=color:#666>())</span> <span style=color:#666>{</span>
      <span style=color:#a2f;font-weight:700>case</span> SerialPortEvent<span style=color:#666>.</span><span style=color:#b44>BI</span><span style=color:#666>:</span>
      <span style=color:#a2f;font-weight:700>case</span> SerialPortEvent<span style=color:#666>.</span><span style=color:#b44>OE</span><span style=color:#666>:</span>
      <span style=color:#a2f;font-weight:700>case</span> SerialPortEvent<span style=color:#666>.</span><span style=color:#b44>FE</span><span style=color:#666>:</span>
      <span style=color:#a2f;font-weight:700>case</span> SerialPortEvent<span style=color:#666>.</span><span style=color:#b44>PE</span><span style=color:#666>:</span>
      <span style=color:#a2f;font-weight:700>case</span> SerialPortEvent<span style=color:#666>.</span><span style=color:#b44>CD</span><span style=color:#666>:</span>
      <span style=color:#a2f;font-weight:700>case</span> SerialPortEvent<span style=color:#666>.</span><span style=color:#b44>CTS</span><span style=color:#666>:</span>
      <span style=color:#a2f;font-weight:700>case</span> SerialPortEvent<span style=color:#666>.</span><span style=color:#b44>DSR</span><span style=color:#666>:</span>
      <span style=color:#a2f;font-weight:700>case</span> SerialPortEvent<span style=color:#666>.</span><span style=color:#b44>RI</span><span style=color:#666>:</span>
      <span style=color:#a2f;font-weight:700>case</span> SerialPortEvent<span style=color:#666>.</span><span style=color:#b44>OUTPUT_BUFFER_EMPTY</span><span style=color:#666>:</span>
        <span style=color:#a2f;font-weight:700>break</span><span style=color:#666>;</span>
      <span style=color:#a2f;font-weight:700>case</span> SerialPortEvent<span style=color:#666>.</span><span style=color:#b44>DATA_AVAILABLE</span><span style=color:#666>:</span>
        <span style=color:#0b0;font-weight:700>byte</span><span style=color:#666>[]</span> readBuffer <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> <span style=color:#0b0;font-weight:700>byte</span><span style=color:#666>[</span>50<span style=color:#666>];</span>

      <span style=color:#a2f;font-weight:700>try</span> <span style=color:#666>{</span>
        <span style=color:#a2f;font-weight:700>while</span> <span style=color:#666>(</span>inputStream<span style=color:#666>.</span><span style=color:#b44>available</span><span style=color:#666>()</span> <span style=color:#666>&gt;</span> 0<span style=color:#666>)</span> <span style=color:#666>{</span>
          inputStream<span style=color:#666>.</span><span style=color:#b44>read</span><span style=color:#666>(</span>readBuffer<span style=color:#666>);</span>
        <span style=color:#666>}</span>
        StringBuilder receivedMsg <span style=color:#666>=</span> <span style=color:#a2f;font-weight:700>new</span> StringBuilder<span style=color:#666>(</span><span style=color:#b44>&#34;/-- &#34;</span><span style=color:#666>);</span>
        receivedMsg<span style=color:#666>.</span><span style=color:#b44>append</span><span style=color:#666>(</span><span style=color:#a2f;font-weight:700>new</span> String<span style=color:#666>(</span>readBuffer<span style=color:#666>).</span><span style=color:#b44>trim</span><span style=color:#666>()).</span><span style=color:#b44>append</span><span style=color:#666>(</span><span style=color:#b44>&#34; --/\n&#34;</span><span style=color:#666>);</span>
        readTa<span style=color:#666>.</span><span style=color:#b44>append</span><span style=color:#666>(</span>receivedMsg<span style=color:#666>.</span><span style=color:#b44>toString</span><span style=color:#666>());</span>
        reciveCount<span style=color:#666>++;</span>
        statusLb<span style=color:#666>.</span><span style=color:#b44>setText</span> <span style=color:#666>(</span><span style=color:#b44>&#34;Send: &#34;</span>sendCount plus<span style=color:#b44>&#34; receive: &#34;&#34;-reciveCount&#34;</span><span style=color:#666>);</span>
      <span style=color:#666>}</span> <span style=color:#a2f;font-weight:700>catch</span> <span style=color:#666>(</span>IOException e<span style=color:#666>)</span> <span style=color:#666>{</span>
        showErrMesgbox<span style=color:#666>(</span>e<span style=color:#666>.</span><span style=color:#b44>getMessage</span><span style=color:#666>());</span>
      <span style=color:#666>}</span>
    <span style=color:#666>}</span>
  <span style=color:#666>}</span>
  
  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   Set the switch status of each component
</span><span style=color:#080;font-style:italic>   :: @param the enabled status
</span><span style=color:#080;font-style:italic>   :: @since March 23, 2012 12:06:24 AM
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>setComponentsEnabled</span><span style=color:#666>(</span><span style=color:#0b0;font-weight:700>boolean</span> enabled<span style=color:#666>)</span> <span style=color:#666>{</span>
    openPortBtn<span style=color:#666>.</span><span style=color:#b44>setEnabled</span><span style=color:#666>(</span>enabled<span style=color:#666>);</span>
    openPortBtn<span style=color:#666>.</span><span style=color:#b44>setEnabled</span><span style=color:#666>(</span>enabled<span style=color:#666>);</span>
    portCombox<span style=color:#666>.</span><span style=color:#b44>setEnabled</span><span style=color:#666>(</span>enabled<span style=color:#666>);</span>
    rateCombox<span style=color:#666>.</span><span style=color:#b44>setEnabled</span><span style=color:#666>(</span>enabled<span style=color:#666>);</span>
    dataCombox<span style=color:#666>.</span><span style=color:#b44>setEnabled</span><span style=color:#666>(</span>enabled<span style=color:#666>);</span>
    stopCombox<span style=color:#666>.</span><span style=color:#b44>setEnabled</span><span style=color:#666>(</span>enabled<span style=color:#666>);</span>
    parityCombox<span style=color:#666>.</span><span style=color:#b44>setEnabled</span><span style=color:#666>(</span>enabled<span style=color:#666>);</span>
  <span style=color:#666>}</span>
  
  <span style=color:#080;font-style:italic>/**
</span><span style=color:#080;font-style:italic>   Run the main function
</span><span style=color:#080;font-style:italic>   * @param args
</span><span style=color:#080;font-style:italic>   :: @since 2012-3-23 at 12:06:45 AM
</span><span style=color:#080;font-style:italic>   */</span>
  <span style=color:#a2f;font-weight:700>public</span> <span style=color:#a2f;font-weight:700>static</span> <span style=color:#0b0;font-weight:700>void</span> <span style=color:#00a000>main</span><span style=color:#666>(</span>String<span style=color:#666>[]</span> args<span style=color:#666>)</span> <span style=color:#666>{</span>
    <span style=color:#a2f;font-weight:700>new</span> JavaRs232<span style=color:#666>();</span>    
  <span style=color:#666>}</span>
<span style=color:#666>}</span>

</code></pre></div><p>The code is written, press the F11 key to enter the debugging state, everything is working well, please see figure:</p><p>:: Start the interface</p><p><img src=http://myblog.lisenhui.cn/2012/03-24-java-hard-rsr232-3.png-alias alt=java-hard-rsr232-3></p><p>Port detection</p><p><img src=http://myblog.lisenhui.cn/2012/03-24-java-hard-rsr232-4.png-alias alt=java-hard-rsr232-4></p><p>:: Communication testing</p><p><img src=http://myblog.lisenhui.cn/2012/03-24-java-hard-rsr232-5.png-alias alt=java-hard-rsr232-5></p><p>Finally take the time to beautify the program, the effect is more beautiful</p><p><img src=http://myblog.lisenhui.cn/2012/03-24-java-hard-rsr232-6.png-alias alt=java-hard-rsr232-6></p><p><img src=http://myblog.lisenhui.cn/2012/03-24-java-hard-rsr232-7.png-alias alt=java-hard-rsr232-7></p><p>PS: (<a href=http://dl.iteye.com/topics/download/80f67e6e-45eb-31ff-8086-da09f8d5762e>http://dl.iteye.com/topics/download/80f67e6e-45eb-31ff-8086-da09f8d5762e</a>)</p></div><footer class=post-footer><div class=post-tags><a href=/en/tags/java rel=tag title=Java>#Java#</a>
<a href=/en/tags/rsr232 rel=tag title=RSR232>#RSR232#</a></div><div class=addthis_inline_share_toolbox></div><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-6049e46e9ee22127"></script><div class=post-nav><div class=article-copyright><div class=article-copyright-img><img src=/img/qq_qrcode.png width=129px height=129px><div style=text-align:center>QQ QrCode</div></div><div class=article-copyright-info><p><span>Declaration：</span>Java program and RSR232 serial communication skills</p><p><span>Link：</span>https://lisenhui.cn/en/2012/03/24/java-hard-rsr232.html</p><p><span>Author：</span>Elkan.Li</p><p><span>Declaration： </span>This blog post article is under the <a href=https://creativecommons.org/licenses/by-nc-sa/3.0/ target=_blank style=text-decoration:underline>CC BY-NC-SA 3.0</a> license,Please indicate the source!</p></div></div><div class=clear></div></div><div class=reward-qr-info><div>If it can help you, you can give tips for blogger that how much you can. ^_^</div><button id=rewardButton disable=enable onclick="var qr=document.getElementById('QR');if(qr.style.display==='none'){qr.style.display='block';}else{qr.style.display='none'}">
<span>Reward</span></button><div id=QR style=display:none><div id=wechat style=display:inline-block><img id=wechat_qr src=/img/wechat-pay.png alt="WeChat Pay"><p>Wechat Pay</p></div><div id=alipay style=display:inline-block><img id=alipay_qr src=/img/ali-pay.png alt=Alipay><p>Ali Pay</p></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=https://lisenhui.cn/en/2012/04/20/nutz-jdoc-chinese.html rel=next title="Nutz source Jdoc has a garbled solution when filling in the prompt in the IDE"><i class="fa fa-chevron-left"></i>Nutz source Jdoc has a garbled solution when filling in the prompt in the IDE</a></div><div class="post-nav-prev post-nav-item"><a href=https://lisenhui.cn/en/2012/01/13/nutz-ke-lhg-my97.html rel=prev title="Domestic technology power joins forces with Nutz, KindEditor, LHGDialog, My97DatePicker">Domestic technology power joins forces with Nutz, KindEditor, LHGDialog, My97DatePicker
<i class="fa fa-chevron-right"></i></a></div></div><div id=waline></div></footer></article></section></div></div><div class=sidebar-toggle><div class=sidebar-toggle-line-wrap><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id=sidebar class=sidebar><div class=sidebar-inner><section class="site-overview sidebar-panel sidebar-panel-active"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image src=/img/avatar.png alt=Elkan.Li><p class=site-author-name itemprop=name>Elkan.Li</p><p class="site-description motion-element" itemprop=description>Never forget your dreams！</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href=/en/post/><span class=site-state-item-count>51</span>
<span class=site-state-item-name>Blogs</span></a></div><div class="site-state-item site-state-categories"><a href=/en/categories/><span class=site-state-item-count>25</span>
<span class=site-state-item-name>Categories</span></a></div><div class="site-state-item site-state-tags"><a href=/en/tags/><span class=site-state-item-count>59</span>
<span class=site-state-item-name>Tags</span></a></div></nav><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/elkan1788/ target=_blank title=GitHub><i class="fa fa-fw fa-github"></i>GitHub</a></span>
<span class=links-of-author-item><a href=https://www.zhihu.com/people/fan-meng-xing-chen-1 target=_blank title=ZhiHu><i class="fa fa-fw fa-globe"></i>ZhiHu</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class=links-of-blogroll-title><i class="fa fa-fw fa-globe"></i>Links</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://nutzam.com/ title=Nutz target=_blank>Nutz</a></li><li class=links-of-blogroll-item><a href=https://jfinal.com/ title=JFinal target=_blank>JFinal</a></li><li class=links-of-blogroll-item><a href=http://wendal.net/ title=Wendal target=_blank>Wendal</a></li><li class=links-of-blogroll-item><a href=https://www.liaoxuefeng.com/ title=LiaoXueFeng target=_blank>LiaoXueFeng</a></li><li class=links-of-blogroll-item><a href=https://qybit.gitee.io/ title="Qybit's Blog" target=_blank>Qybit's Blog</a></li></ul></div><div class="tagcloud-of-blogroll motion-element tagcloud-of-blogroll-inline"><div class=tagcloud-of-blogroll-title><i class="fa fa-fw fa-tags"></i>TagCloud</div><ul class=tagcloud-of-blogroll-list><li class=tagcloud-of-blogroll-item><a href=/en/tags/big-data>Big data</a></li><li class=tagcloud-of-blogroll-item><a href=/en/tags/linux>Linux</a></li><li class=tagcloud-of-blogroll-item><a href=/en/tags/blog>Blog</a></li><li class=tagcloud-of-blogroll-item><a href=/en/tags/git>Git</a></li><li class=tagcloud-of-blogroll-item><a href=/en/tags/github>Github</a></li><li class=tagcloud-of-blogroll-item><a href=/en/tags/java>Java</a></li><li class=tagcloud-of-blogroll-item><a href=/en/tags/kindeditor>Kindeditor</a></li><li class=tagcloud-of-blogroll-item><a href=/en/tags/python>Python</a></li><li class=tagcloud-of-blogroll-item><a href=/en/tags/axure>Axure</a></li><li class=tagcloud-of-blogroll-item><a href=/en/tags/front>Front</a></li></ul></div><div class="links-of-blogroll motion-element inline"><script type=text/javascript src="//rf.revolvermaps.com/0/0/6.js?i=5s83wolvn69&m=7&c=e63100&cr1=ffffff&f=arial&l=0&bv=90&lx=-420&ly=420&hi=20&he=7&hc=a8ddff&rs=80" async></script></div></section></div></aside></div></main><footer id=footer class=footer><div class=footer-inner><div class=copyright><span class=copyright-year>&copy; 2010 - 2021</span>
<span class=with-love><i class="fa fa-heart"></i></span><span class=copyright-author>Loving life and dreams.</span></div><div class=powered-info><span class=powered-by>Powered by - <a class=powered-link href=//gohugo.io target=_blank title=hugo>Hugo v0.80.0</a></span>
<span class=separator-line>/</span>
<span class=theme-info>Theme by - <a class=powered-link href=//github.com/elkan1788/hugo-theme-next target=_blank>NexT</a></span></div><div class=vistor-info><span class=cnzz_icon id=cnzz_stat_icon_1279205305><a href="//www.cnzz.com/stat/website.php?web_id=1279205305" target=_blank title=站长统计><img border=0 hspace=0 vspace=0 src=//icon.cnzz.com/img/pic1.gif></a></span>
<script type=text/javascript>(function(){var cnzz_s_tag=document.createElement('script');cnzz_s_tag.type='text/javascript';cnzz_s_tag.async=true;cnzz_s_tag.charset='utf-8';cnzz_s_tag.src='https://s4.cnzz.com/z_stat.php?id=1279205305&show=pic1';var root_s=document.getElementsByTagName('script')[0];root_s.parentNode.insertBefore(cnzz_s_tag,root_s);})();</script><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><span class=site-uv><i class="fa fa-user"></i><span class=busuanzi-value id=busuanzi_value_site_uv></span></span><span class=separator-line>/</span>
<span class=site-pv><i class="fa fa-eye"></i><span class=busuanzi-value id=busuanzi_value_site_pv></span></span></div><div class=license-info><span class=storage-info>Storage by
<a href=https://www.qiniu.com style=font-weight:700 target=_blank>Qiniu Cloud</a></span>
<span class=separator-line>/</span>
<span class=license-num><a href=http://beian.miit.gov.cn target=_blank>ICP.No 18047355</a></span></div></div></footer><div class=back-to-top><i class="fa fa-arrow-up"></i><span id=scrollpercent><span>0</span>%</span></div></div><script type=text/javascript src=//cdn.bootcdn.net/ajax/libs/jquery/2.1.4/jquery.min.js></script><script src=//cdn.bootcdn.net/ajax/libs/imageviewer/0.1.0/viewer.min.js></script><script type=text/javascript src=/js/search.js></script><script type=text/javascript src=/js/affix.js></script><script type=text/javascript src=/js/scrollspy.js></script><script type=text/javascript>function getCntViewHeight(){var docHeight=$('#content').height(),winHeight=$(window).height(),cntViewHeight=(docHeight>winHeight)?(docHeight-winHeight):($(document).height()-winHeight);return cntViewHeight;}
function getScrollbarWidth(){var $div=$('<div />').addClass('scrollbar-measure').prependTo('body');var div=$div[0];var scrollbarWidth=div.offsetWidth-div.clientWidth;$div.remove();return scrollbarWidth;}
function registerBackTop(){var THRESHOLD=50;var $top=$('.back-to-top');$(window).on('scroll',function(){$top.toggleClass('back-to-top-on',window.pageYOffset>THRESHOLD);var scrollTop=$(window).scrollTop();var cntViewHeight=getCntViewHeight();var scrollPercent=(scrollTop)/(cntViewHeight);var scrollPercentRounded=Math.round(scrollPercent*100);var scrollPercentMaxed=(scrollPercentRounded>100)?100:scrollPercentRounded;$('#scrollpercent>span').html(scrollPercentMaxed);});$top.on('click',function(){$("html,body").animate({scrollTop:0,screenLeft:0,},800);});}
function initScrollSpy(){var tocSelector='.post-toc';var $tocElement=$(tocSelector);var activeCurrentSelector='.active-current';$tocElement.on('activate.bs.scrollspy',function(){var $currentActiveElement=$(tocSelector+' .active').last();removeCurrentActiveClass();$currentActiveElement.addClass('active-current');}).on('clear.bs.scrollspy',removeCurrentActiveClass);$('body').scrollspy({target:tocSelector});function removeCurrentActiveClass(){$(tocSelector+' '+activeCurrentSelector).removeClass(activeCurrentSelector.substring(1));}}
function initAffix(){var headerHeight=$('.header-inner').height();var footerOffset=parseInt($('.main').css('padding-bottom'),10);var sidebarTop=headerHeight+10;$('.sidebar-inner').affix({offset:{top:sidebarTop,bottom:footerOffset}});$(document).on('affixed.bs.affix',function(){updateTOCHeight(document.body.clientHeight-100);});}
function initTOCDimension(){var updateTOCHeightTimer;$(window).on('resize',function(){updateTOCHeightTimer&&clearTimeout(updateTOCHeightTimer);updateTOCHeightTimer=setTimeout(function(){var tocWrapperHeight=document.body.clientHeight-100;updateTOCHeight(tocWrapperHeight);},0);});updateTOCHeight(document.body.clientHeight-100);var scrollbarWidth=getScrollbarWidth();$('.post-toc').css('width','calc(100% + '+scrollbarWidth+'px)');}
function updateTOCHeight(height){height=height||'auto';$('.post-toc').css('max-height',height);}
$(function(){var sidebarTop=$('.header-inner').height()+10;$('#sidebar').css({'margin-top':sidebarTop}).show();var headerHeight=$('.header-inner').height();var sidebarHeight=$('.sidebar-inner').height();var leftHeight=headerHeight+sidebarHeight+50;var contentHeight=$('.content-wrap').height();if(contentHeight<leftHeight){$('.content-wrap').css('height',leftHeight+50);}
$('.site-nav-toggle button').on('click',function(){var $siteNav=$('.site-nav');var ON_CLASS_NAME='site-nav-on';var isSiteNavOn=$siteNav.hasClass(ON_CLASS_NAME);var animateAction=isSiteNavOn?'slideUp':'slideDown';var animateCallback=isSiteNavOn?'removeClass':'addClass';$siteNav.stop()[animateAction]('fast',function(){$siteNav[animateCallback](ON_CLASS_NAME);});});registerBackTop();initScrollSpy();initAffix();initTOCDimension();$('.post-body').viewer();$('.sidebar-nav-toc').click(function(){$(this).addClass('sidebar-nav-active');$(this).next().removeClass('sidebar-nav-active');$('.'+$(this).next().attr('data-target')).toggle(500);$('.'+$(this).attr('data-target')).toggle(500);});$('.sidebar-nav-overview').click(function(){$(this).addClass('sidebar-nav-active');$(this).prev().removeClass('sidebar-nav-active');$('.'+$(this).prev().attr('data-target')).toggle(500);$('.'+$(this).attr('data-target')).toggle(500);});if(document.body.clientWidth>800){daovoice('init',{app_id:"f89653b8"});daovoice('update');}});</script><script src=//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js></script><script type=text/javascript>new Waline({el:'#waline',visitor:true,placeholder:' Just do what you want leave here. ^_^ \n\n Please insert your email which can receive the email that will keep our chat. ',requiredFields:['nick','mail'],serverURL:"https:\/\/waline.lisenhui.cn",lang:"en"});</script><script>(function(){var bp=document.createElement('script');var curProtocol=window.location.protocol.split(':')[0];if(curProtocol==='https'){bp.src='https://zz.bdstatic.com/linksubmit/push.js';}
else{bp.src='http://push.zhanzhang.baidu.com/push.js';}
var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s);})();</script><script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:'==document.location.protocol?'https:':'http:')+"//widget.daovoice.io/widget/f89653b8.js","daovoice")</script></body></html>