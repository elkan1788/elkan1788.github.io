<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.104.3"><link rel="shortcut icon" type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/x-icon href=/imgs/icons/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs/icons/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/imgs/icons/favicon-32x32.png><link rel=apple-touch-icon sizes=180x180 href=/imgs/icons/apple-touch-icon.png><meta itemprop=name content="使用自定义域名激活Vercel部署的Waline服务"><meta itemprop=description content="近期vercel.app域名遭受DNS污染，导致国内无法直接访问旗下的二级域名，进而让很多使用vercel部署的服务都无法正常运行，为此可通过自定义域名方式来恢复正常的访问。"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://lisenhui.cn/imgs/avatar.png"><meta itemprop=keywords content="vercel,waline"><meta property="og:type" content="article"><meta property="og:title" content="使用自定义域名激活Vercel部署的Waline服务"><meta property="og:description" content="近期vercel.app域名遭受DNS污染，导致国内无法直接访问旗下的二级域名，进而让很多使用vercel部署的服务都无法正常运行，为此可通过自定义域名方式来恢复正常的访问。"><meta property="og:image" content="/imgs/avatar.png"><meta property="og:image:width" content="312"><meta property="og:image:height" content="312"><meta property="og:image:type" content="image/jpeg/png/svg/jpg"><meta property="og:url" content="https://lisenhui.cn/blog/use-custom-domain-active-vercel-waline.html"><meta property="og:site_name" content="热爱生活与梦想"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="凡梦星尘"><meta property="article:published_time" content="2022-09-01 21:23:03 +0800 +0800"><meta property="article:modified_time" content="2022-09-01 21:23:03 +0800 +0800"><link type=text/css rel=stylesheet href=https://unpkg.com/@fortawesome/fontawesome-free@6.1.2/css/all.min.css><link type=text/css rel=stylesheet href=https://unpkg.com/animate.css@3.1.1/animate.min.css><link rel=stylesheet href=/css/main.min.023a7a717f04b05c4143aebed40baf5d1de6d69d8cfe1a6c7167ff49979a8fd0.css><style type=text/css>.post-footer,.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><link rel=stylesheet type=text/css href=/css/custom_style.css><script class=next-config data-name=page type=application/json>{"comments":true,"isHome":false,"isPage":true,"path":"use-custom-domain-active-vercel-waline.html","permalink":"https://lisenhui.cn/blog/use-custom-domain-active-vercel-waline.html","title":"使用自定义域名激活Vercel部署的Waline服务"}</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.id="LA_COLLECT",e.src="https://sdk.51.la/js-sdk-pro.min.js",e.async="true",e.onload=function(){LA.init({id:"JhW0FuUlJYQmqAJt",ck:"JhW0FuUlJYQmqAJt",autoTrack:!0})},document.head.appendChild(e)})</script><title>使用自定义域名激活Vercel部署的Waline服务 - 热爱生活与梦想</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label=切换导航栏 role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>热爱生活与梦想</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>没有伞的孩子要学会努力奔跑 ✊</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>首页</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>关于</a></li><li class="menu-item menu-item-blog"><a href=/blog/ class=hvr-icon-pulse rel=section><i class="fa fa-blog hvr-icon"></i>博客点滴</a></li><li class="menu-item menu-item-tech"><a href=/tech/ class=hvr-icon-pulse rel=section><i class="fa fa-swatchbook hvr-icon"></i>技术集锦</a></li><li class="menu-item menu-item-flinks"><a href=/flinks.html class=hvr-icon-pulse rel=section><i class="fa fa-link hvr-icon"></i>友情链接</a></li><li class="menu-item menu-item-archives"><a href=/archives/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>归档
<span class=badge>67</span></a></li><li class="menu-item menu-item-commonweal"><a href=/404.html class=hvr-icon-pulse rel=section><i class="fa fa-heartbeat hvr-icon"></i>公益 404</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class=search-result-container><div class=algolia-hits></div></div><div class=search-footer><div class=algolia-pagination></div><div class=search-meta-info><div class="search-hit-stats algolia-stats"></div><div class=search-vendor><span>Search By</span>
<img src=/imgs/algolia-logo.svg></div></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目录</li><li class=sidebar-nav-overview>站点概览</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#确定方案>确定方案</a></li><li><a href=#方案1>方案1</a><ul><li><a href=#dns-server转发>DNS Server转发</a></li></ul></li><li><a href=#方案2>方案2</a><ul><li><a href=#申请免费域名>申请免费域名</a></li></ul></li><li><a href=#评论搬迁>评论搬迁</a></li><li><a href=#吐槽感言>吐槽感言</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=凡梦星尘 src=/imgs/avatar.png><p class=site-author-name itemprop=name>凡梦星尘</p><div class=site-description itemprop=description>再平凡的人也有属于他的梦想 ✨</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>67</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>28</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>80</span>
<span class=site-state-item-name>标签</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://github.com/elkan1788 title="Github → https://github.com/elkan1788" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>Github</a></span>
<span class=links-of-social-item><a href=https://www.zhihu.com/people/lisenhui title="知乎 → https://www.zhihu.com/people/lisenhui" rel=noopener class=hvr-icon-pulse target=_blank><i class="fa fa-book fa-fw hvr-icon"></i>知乎</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh class=cc-opacity rel=noopener target=_blank title=共享知识><img src=/imgs/cc/big/by_nc_sa.svg alt=共享知识></a></div><div class=xyears-blog><a href=https://www.foreverblog.cn/blog/3306.html target=_blank><img src=https://img.foreverblog.cn/logo_en_default.png title=十年之约 style=width:auto;height:16px></a>
<a href=https://www.foreverblog.cn/go.html target=_blank><img src=https://img.foreverblog.cn/wormhole_3.gif alt style=width:auto;height:24px title=穿梭虫洞-随机访问十年之约友链博客></a></div></div></div></div><div class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>网站资讯</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已运行：</div><div class=item-count id=runTimes data-publishdate=2010-09-05T10:11:53+00:00></div></div><div id=la-siteinfo-widget style=display:none><script id=LA-DATA-WIDGET crossorigin=anonymous src="https://v6-widget.51.la/v6/JhW0FuUlJYQmqAJt/quote.js?theme=0&col=true&f=12&display=0,0,0,1,0,1,1,1"></script></div><div class=siteinfo-item><div class=item-name><i class="fa fa-user-plus"></i>今日访问：</div><div class=item-count id=today_site_pv></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-user-clock"></i>昨日访问：</div><div class=item-count id=yesterday_site_pv></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-arrows-down-to-people"></i>本月访问：</div><div class=item-count id=month_site_pv></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-users"></i>总访问量：</div><div class=item-count id=total_site_pv></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>总字数：</div><div class=item-count id=wordsCount data-count=78183></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>阅读约：</div><div class=item-count id=readTimes data-times=191></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最后更新于：</div><div class=item-count id=last-push-date data-lastpushdate=2022-10-04T16:32:53+08:00></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直达评论><i class="fas fa-comments"></i></div><div id=switch-theme class=button title=深浅模式切换><i class="fas fa-adjust"></i></div><div id=goto-gt class=button title=多语言翻译><i class="fas fa-globe"></i></div><div class=back-to-top role=button title=返回顶部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a>
<a href=https://github.com/elkan1788 rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://lisenhui.cn/blog/use-custom-domain-active-vercel-waline.html><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs/avatar.png"><meta itemprop=name content="凡梦星尘"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="凡梦星尘"><meta itemprop=description content="再平凡的人也有属于他的梦想 ✨"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="使用自定义域名激活Vercel部署的Waline服务"><meta itemprop=description content="近期vercel.app域名遭受DNS污染，导致国内无法直接访问旗下的二级域名，进而让很多使用vercel部署的服务都无法正常运行，为此可通过自定义域名方式来恢复正常的访问。"></span><header class=post-header><h1 class=post-title itemprop="name headline">使用自定义域名激活Vercel部署的Waline服务
<a href=https://github.com/elkan1788/myblog-sources/tree/main/content/blog/2022/09-01-use-custom-domain-active-vercel-waline.md rel="noopener external nofollow noreferrer" target=_blank class="exturl post-edit-link" title=编辑><i class="fa fa-pen-nib"></i></a></h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-calendar"></i></span>
<span class=post-meta-item-text>发表于：</span>
<time title="发表于：2022-09-01 21:23:03 +0800 +0800" itemprop="dateCreated datePublished" datetime="2022-09-01 21:23:03 +0800 +0800">2022-09-01</time></span>
<span class=post-meta-item><span class=post-meta-item-icon><i class="far fa-folder-open"></i></span>
<span class=post-meta-item-text>分类于：</span>
<span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/%E7%BD%91%E7%BB%9C itemprop=url rel=index><span itemprop=name>网络</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字数><span class=post-meta-item-icon><i class="far fa-file-word"></i></span>
<span class=post-meta-item-text>字数：</span><span>1216</span></span>
<span class=post-meta-item title=阅读><span class=post-meta-item-icon><i class="far fa-clock"></i></span>
<span class=post-meta-item-text>阅读：&ap;</span>
<span>3分钟</span></span>
<span class=post-meta-item title=浏览><span class=post-meta-item-icon><i class="far fa-eye"></i></span>
<span class=post-meta-item-text>浏览：</span>
<span id=waline-pageview-count data-path=/blog/use-custom-domain-active-vercel-waline.html><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><p>近期对于部分 Waline 评论插件的用户来说，或许是非常的困扰时期。先是服务商 LeanCloud 发布国内提供的服务，从8月份起需要绑定自有案例域名才能正常运行。而这两天 Vercel (Waline 官方提供的免费部署方案，也是大部用户的选择)旗下的 <code>vercel.app</code> 域名又遭受 DNS 污染攻击，在国内无法直接访问此域名，导致众多 Waline 用户的服务直接陷入“宕机”状态，真可谓是雪上加霜。</p><p>有句话说的好：“只要思想不滑坡，办法总比困难多”。接下来就是给大家分享下，如何通过自定义域名的方式来解决上面遇到的2个问题，此方法仅供各位网友参考参考。 😄</p><h2 id=确定方案>确定方案</h2><p>由于 <code>vercel.app</code> 域名已经被 DNS 污染，那么国内网络应该都是无法进行访问的，所以原本想直接通过已有域名 DNS 的 CNAME 对<code>vercel.app</code>域名转发的想法是不能实现的。通过多次验证后，确认如下 2 套方案：</p><div class="note info"><ul><li>方案1： 有备案可用域名，直接转发Vercel DNS Server地址</li><li>方案2： 申请免费域名，配置 Vercel 提供的 DNS 服务器</li></ul></div><h2 id=方案1>方案1</h2><h3 id=dns-server转发>DNS Server转发</h3><p>在自有域名的 DNS 服务中添加一条记录，选择 CNAME 类型转发，记录值填写为：<code>cname.vercel-dns.com</code>，参考如下：</p><p><img src=//imgs.lisenhui.cn/blog/2022/09-01-use-domain-active-waline-01.png alt="DNS Records"></p><p>然后在 Vercel 中找到 Waline 后端服务的项目，点击<code>Settings</code>标签卡，跳转页面后点击左侧的<code>Domains菜单项，输入你自己定义的域名点击</code>Add`按钮即可。</p><p><img src=//imgs.lisenhui.cn/blog/2022/09-01-use-domain-active-waline-02.png alt=Domains></p><h2 id=方案2>方案2</h2><h3 id=申请免费域名>申请免费域名</h3><p>可以参考之前发布的文章：
<a href=https://lisenhui.cn/tech/create-your-forever-org-domain.html title=创建属于你自己的org永久域名 rel="noopener external nofollow noreferrer" target=_blank class=exturl>创建属于你自己的org永久域名
<i class="fa fa-external-link-alt"></i>
</a>，不过这里不需要借助 DNSPOD 提供的解析服务，所以在申请域名时可以直接填写 Vercel 提供的 DNS 服务，默认地址为：</p><ul><li><code>ns1.vercel-dns.com</code></li><li><code>ns2.vercel-dns.com</code></li></ul><p>域名申请下来后，访问 Vercel 的域名控制面板
<a href=https://vercel.com/dashboard/domains title="Domains Dashboard" rel="noopener external nofollow noreferrer" target=_blank class=exturl>Domains Dashboard
<i class="fa fa-external-link-alt"></i></a> 点击右上角的<code>Add</code>按钮选择你的 Waline 项目点击<code>Continue</code>按钮，再输入申请好的域名确认即可。</p><h2 id=评论搬迁>评论搬迁</h2><p>除了域名访问的问题外，还需要注意当使用 LeanCloud 国内版作为存储时需要有自定义的备案域名，要是没有的话就只好选择国际版本。那么就要对于已有的数据进行迁移，但 Waline 自带的导入导出功能还是有些问题
<a href=https://github.com/walinejs/waline/discussions/1148 title=#1148 rel="noopener external nofollow noreferrer" target=_blank class=exturl>#1148
<i class="fa fa-external-link-alt"></i>
</a>，建议最好还是使用 LeanCloud 自带的导入导出功能，不过需要进行手动的调整。</p><p>第一步是对数据进行导出，这里只需选取<code>Counter</code>、<code>Comment</code>和<code>Users</code>三个 Schema 文件，参考如下：</p><p><img src=//imgs.lisenhui.cn/blog/2022/09-01-use-domain-active-waline-03.png alt="Export Data"></p><p>第二步是对数据进行调整，需要在 Date 类型的字段中都加上 <code>_type</code> 标识，避免导入后 Waline 无法插入新的评论数据，为此写了个 Python 脚本进行批量的修改，参考如下：</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>append_date_type</span>(source, target):
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;&#34;&#34;修改waline date 类型
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  :param source: 原始文件
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  :param target: 目标文件
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>with</span> open(source, <span style=color:#e6db74>&#34;wb+&#34;</span>) <span style=color:#66d9ef>as</span> tf:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(target, <span style=color:#e6db74>&#34;rb+&#34;</span>) <span style=color:#66d9ef>as</span> sf:
</span></span><span style=display:flex><span>      print(<span style=color:#e6db74>&#34;Current File: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>%</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>basename(sf<span style=color:#f92672>.</span>name))
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>          line <span style=color:#f92672>=</span> sf<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span>          line_splits <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>decode()<span style=color:#f92672>.</span>splitlines()
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> len(line_splits) <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>          line_str <span style=color:#f92672>=</span> line_splits[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>strip(<span style=color:#e6db74>&#39;,&#39;</span>)
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;createdAt&#39;</span> <span style=color:#f92672>in</span> line_str:
</span></span><span style=display:flex><span>            new_ca <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#34;createdAt&#34;: {&#34;__type&#34;:&#34;Date&#34;,&#34;iso&#34;:&#39;</span><span style=color:#f92672>+</span>line_str<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;: &#39;</span>)[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>+</span><span style=color:#e6db74>&#39;},</span><span style=color:#ae81ff>\r\n</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>            tf<span style=color:#f92672>.</span>write(new_ca<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>elif</span> <span style=color:#e6db74>&#39;insertedAt&#39;</span> <span style=color:#f92672>in</span> line_str:
</span></span><span style=display:flex><span>            new_ia <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#34;insertedAt&#34;: {&#34;__type&#34;:&#34;Date&#34;,&#34;iso&#34;:&#39;</span><span style=color:#f92672>+</span>line_str<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;: &#39;</span>)[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>+</span><span style=color:#e6db74>&#39;},</span><span style=color:#ae81ff>\r\n</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>            tf<span style=color:#f92672>.</span>write(new_ia<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>elif</span> <span style=color:#e6db74>&#39;updatedAt&#39;</span> <span style=color:#f92672>in</span> line_str:
</span></span><span style=display:flex><span>            new_ua <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#34;updatedAt&#34;: {&#34;__type&#34;:&#34;Date&#34;,&#34;iso&#34;:&#39;</span><span style=color:#f92672>+</span>line_str<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;: &#39;</span>)[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>+</span><span style=color:#e6db74>&#39;},</span><span style=color:#ae81ff>\r\n</span><span style=color:#e6db74>&#39;</span>
</span></span><span style=display:flex><span>            tf<span style=color:#f92672>.</span>write(new_ua<span style=color:#f92672>.</span>encode())
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            tf<span style=color:#f92672>.</span>write(line)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span>:
</span></span><span style=display:flex><span>          print(<span style=color:#e6db74>&#39;Somethings wrong!!!&#39;</span>)
</span></span><span style=display:flex><span>          traceback<span style=color:#f92672>.</span>print_exc()
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>
</span></span></code></pre></td></tr></table></div></div><p>把修改好的 json 数据，使用 LeandCloud 的导入功能重新导入，然后在 Waline 后台管理界面就能看到数据，前端也能正常的提交新评论。</p><h2 id=吐槽感言>吐槽感言</h2><p>相信经过上述的折腾后，此时此刻的你，应该对那句“免费的东西总是最贵的”话语有种深刻的体验了吧。但是这番的折腾也还算是值得的，学习到不少的新知识，又一次锤炼的了自己的技术，也正是验证开头说的那句话“办法总比困难多”，对吧！😁</p></div><footer class=post-footer><div class=post-tags><a href=/tags/vercel>vercel</a>
<a href=/tags/waline>waline</a></div><div class=addthis_inline_share_toolbox style=text-align:center></div><hr><div class=reward-container><div><i class="fa-solid fa-mug-hot"></i>请我喝杯咖啡吧 ヾ(^▽^*)))</div><button>赞赏</button><div class=post-reward><div class=post-reward-item><img src=/imgs/ali-pay.png alt="凡梦星尘 - 支付宝">
<span>支付宝</span></div><div class=post-reward-item><img src=/imgs/wechat-pay.png alt="凡梦星尘 - 微信">
<span>微信</span></div></div></div><div class=post-copyright><img src=/imgs/cc/cc.svg width=75 height=75 align=right><ul><li class=post-copyright-title><strong>文章标题：</strong>
使用自定义域名激活Vercel部署的Waline服务</li><li class=post-copyright-author><strong>本文作者：</strong>
凡梦星尘</li><li class=post-copyright-link><strong>本文链接：</strong>
<a id=post-cr-link href=https://lisenhui.cn/blog/use-custom-domain-active-vercel-waline.html title=使用自定义域名激活Vercel部署的Waline服务>https://lisenhui.cn/blog/use-custom-domain-active-vercel-waline.html</a></li><li class=post-copyright-license><strong>版权声明：</strong>
本博客所有文章除特别声明外，均采用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class=followme><span>欢迎关注我的其它发布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=/imgs/qq-channel.jpg><span class=icon><i class="fab fa-qq"></i></span>
<span class=label>QQ</span></a></div><div class=social-item><a target=_blank class=social-link href=/rss.xml><span class=icon><i class="fa fa-rss"></i></span>
<span class=label>RSS</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"></div><div class="post-nav-prev post-nav-item"><a href=/blog/upgrade-blog-use-new-theme.html rel=prev title="博客站点升级使用 Hugo NexT 最新主题">博客站点升级使用 Hugo NexT 最新主题
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span>评论交流</span></div><div class=comment-switch><span class=first-comment>Giscus</span>
<span class="switch-btn move"></span>
<span class=second-comment>Waline</span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=giscus-container></div></div><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=waline-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=google-translate><i class="fa fa-language"></i><div id=google_translate_element></div></div><div class=copyright>&copy;
<span itemprop=copyrightYear>2010 - 2022</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=author itemprop=copyrightHolder>凡梦星尘</span></div><div class=powered-by>由 <a href=https://gohugo.io title=0.104.3 target=_blank>Hugo</a> & <a href=https://github.com/hugo-next/hugo-theme-next title=4.4.0 target=_blank>Hugo NexT.Gemini</a> 强力驱动</div><div class=beian><a href=https://beian.miit.gov.cn target=_blank>粤ICP备 18047355-1 号</a>
<img src=/imgs/gongan.png alt=沪公网安备>
<a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31011402009770" target=_blank>沪公网安备 31011402009770 号</a></div><div class=vendors-list><a target=_blank href=https://upyun.com title=又拍云><img src=/imgs/vendors/upyun.png alt=又拍云></a>
<a target=_blank href=https://github.com title=Github>Github</a>
<a target=_blank href=https://www.leancloud.cn title=LeanCloud>LeanCloud</a>
<a target=_blank href=https://webify.cloudbase.net title=Webify>Webify</a>
<span>提供CDN/云资源支持</span></div></div></footer><script type=text/javascript src=https://unpkg.com/animejs@3.2.1/lib/anime.min.js defer></script>
<script class=next-config data-name=main type=application/json>{"addthis":{"cfg":{"pubid":"ra-6049e46e9ee22127"},"js":"https://s7.addthis.com/js/300/addthis_widget.js"},"algolia":{"cfg":{"apikey":"639c3c5992507251ead7be2153913cd0","appid":"NC5VDOMBRG","enable":true,"hits":{"perpage":10},"indexname":"site_indexes"},"instantjs":{"file":"dist/instantsearch.production.min.js","name":"instantsearch.js","version":"4.40.5"},"js":{"file":"dist/algoliasearch-lite.umd.js","name":"algoliasearch","version":"4.13.0"}},"bookmark":{"color":"#1b1b1b","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Comments","categoryid":"DIC_kwDOE8dfY84CQqz_","emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"elkan1788/elkan1788.github.io","repoid":"MDEwOlJlcG9zaXRvcnkzMzE4MzMxODc=","theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://lisenhui.cn","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小时前","ds_hours":" 小时 ","ds_just":"刚刚","ds_min":" 分钟前","ds_mins":" 分钟","ds_month":" 个月前","ds_years":" 年 ","empty":"没有找到任何搜索结果：${query}","hits":"","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","placeholder":"搜索..."},"lang":"zh-CN","lazyload":false,"motion":{"async":true,"enable":true,"transition":{"collheader":"fadeInLeft","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"rotateInUpRight"}},"root":"/","scheme":"Gemini","sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"vendor":{"plugins":"unpkg","router":"https://unpkg.com"},"version":"4.4.0","waline":{"cfg":{"emoji":false,"imguploader":false,"pageview":"#waline-pageview-count","placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":"https://lcweb.lisenhui.cn","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"waline","file":"dist/waline.css","name":"@waline/client","version":"2.11.3"},"js":{"alias":"waline","file":"dist/waline.js","name":"@waline/client","version":"2.11.3"}}}</script><script type=text/javascript>window.translateelement_styles="/css/gt.min.css"</script><script type=text/javascript src=/js/main.min.2a3d23616bcb1e554ee3206b2ce3cb8589742c3805a25a8e5f910603b4539556.js defer></script></body></html>